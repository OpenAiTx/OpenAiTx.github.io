<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure-Runbooks - My various Azure Automation runbooks used for Intune and other Microsoft 365 tasks</title>
    <meta name="description" content="My various Azure Automation runbooks used for Intune and other Microsoft 365 tasks">
    <meta name="keywords" content="Azure-Runbooks, English, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Azure-Runbooks",
  "description": "My various Azure Automation runbooks used for Intune and other Microsoft 365 tasks",
  "author": {
    "@type": "Person",
    "name": "sargeschultz11"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 61
  },
  "url": "https://OpenAiTx.github.io/projects/sargeschultz11/Azure-Runbooks/README-en.html",
  "sameAs": "https://raw.githubusercontent.com/sargeschultz11/Azure-Runbooks/main/README.md",
  "datePublished": "2025-12-06",
  "dateModified": "2025-12-06"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/sargeschultz11/Azure-Runbooks" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    Azure-Runbooks
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 61 stars</span>
                <span class="language">English</span>
                <span>by sargeschultz11</span>
            </div>
        </div>
        
        <div class="content">
            <h1>Azure-Runbooks </h1></p><p><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
<a href="https://github.com/PowerShell/PowerShell" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/PowerShell-7.2+-blue.svg" alt="PowerShell"></a>
<a href="https://www.microsoft.com/microsoft-365" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Microsoft_365-compatible-brightgreen.svg" alt="Microsoft 365"></a>
<a href="https://developer.microsoft.com/en-us/graph" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Microsoft_Graph-v1.0-blue.svg" alt="Graph API"></a>
<a href="https://azure.microsoft.com/en-us/products/automation" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Azure_Automation-compatible-0089D6.svg" alt="Azure"></a>
<a href="https://GitHub.com/sargeschultz11/Azure-Runbooks/releases/" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/github/release/sargeschultz11/Azure-Runbooks.svg" alt="GitHub release"></a>
<a href="https://github.com/sargeschultz11/Azure-Runbooks" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Maintained-yes-green.svg" alt="Maintenance"></a>
<a href="https://www.microsoft.com/powershell" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/Made%20with-PowerShell-1f425f.svg" alt="Made with"></a></p><p>A collection of Azure Automation runbooks for Microsoft 365 and Intune management.</p><h2>Overview</h2></p><p>This repository contains PowerShell scripts designed to be used as Azure Automation runbooks for automating various Microsoft 365 and Intune management tasks. These scripts help streamline administrative processes, maintain consistency across your environment, and reduce manual overhead.</p><h2>Repository Structure</h2></p><p>The repository is organized into folders, with each folder containing a specific runbook solution:</p><pre><code class="language-">Azure-Runbooks/
├── DeviceCategorySync/             # Sync device categories with user departments
├── Report-DiscoveredApps/          # Generate reports of discovered applications
├── Report-IntuneDeviceCompliance/  # Generate device compliance reports
├── Report-DevicesWithApp/          # Find devices with specific applications
├── Alert-DeviceSyncReminder/       # Send reminders for devices needing sync
├── Update-AutopilotDeviceGroupTags/ # Sync Autopilot group tags with Intune categories
├── Alert-IntuneAppleTokenMonitor/  # Monitor Apple token expirations
├── Report-UserManagers/            # Generate reports of users and their managers
├── Report-MissingSecurityUpdates/  # Report on devices missing security updates
├── Sync-IntuneDevices/             # Force sync all managed Intune devices
├── Report-DeviceSyncOverdue/       # Report on devices overdue for sync
├── Report-OneDriveSharedItems/     # Generate reports of shared items in OneDrive
├── Task-SetCompanyAttribute/       # Set company attribute for all users
├── Snipe-IT-UserSync/              # Sync Microsoft 365 users to Snipe-IT users
├── Sync-IntuneToAction1Categories/ # Sync Intune device categories to Action1 custom attributes</code></pre>
Each runbook folder contains:
<ul><li>The main PowerShell script (<code>.ps1</code>)</li>
<li>A helper script for setting up permissions (<code>Add-GraphPermissions.ps1</code>)</li>
<li>Detailed documentation (<code>README.md</code>)</li></p><p></ul><h2>Authentication</h2></p><p>All runbooks in this repository are designed to use Azure Automation's System-Assigned Managed Identity for authentication, which is the recommended approach for Azure Automation. Each folder includes an <code>Add-GraphPermissions.ps1</code> script that helps assign the necessary Microsoft Graph API permissions to your Automation Account's Managed Identity.</p><h2>Getting Started</h2></p><p>Each runbook includes detailed documentation for implementation and usage. In general, to use these runbooks:</p><ul><li>Import the script into your Azure Automation account</li>
<li>Enable System-Assigned Managed Identity on your Automation account</li>
<li>Use the included <code>Add-GraphPermissions.ps1</code> script to assign necessary Graph API permissions</li>
<li>Configure any required parameters specific to your environment</li>
<li>Schedule the runbook or run it on-demand as needed</li></p><p></ul><h2>Available Runbooks</h2></p><h3>Reporting</h3>
<ul><li><strong>Device Compliance Report</strong>: Generate comprehensive compliance reports for Intune-managed devices.</li>
<li><strong>Discovered Apps Report</strong>: Create detailed reports of applications discovered on managed devices.</li>
<li><strong>Devices with Specific App Report</strong>: Identify all devices with a specific application installed.</li>
<li><strong>User Managers Report</strong>: Generate a report of all licensed internal users along with their manager information.</li>
<li><strong>Missing Security Updates Report</strong>: Identify Windows devices missing multiple security updates with automated reporting.</li>
<li><strong>Device Sync Overdue Report</strong>: Generate reports of devices that haven't synced within a specified threshold.</li>
<li><strong>OneDrive Shared Items Report</strong>: Create reports of items shared externally in OneDrive for Business.</li></p><p></ul><h3>Device Management</h3>
<ul><li><strong>Device Category Sync</strong>: Automatically synchronize Intune device categories based on user department information.</li>
<li><strong>Autopilot Group Tag Sync</strong>: Keep Autopilot device group tags in sync with Intune device categories.</li>
<li><strong>Force Device Sync</strong>: Initiate sync commands for all managed Intune devices with batching and throttling protection.</li>
<li><strong>Intune to Action1 Category Sync</strong>: Sync Intune device categories to Action1 custom attributes by matching serial numbers.</li></p><p></ul><h3>Alerts and Notifications</h3>
<ul><li><strong>Device Sync Reminder</strong>: Send automated email reminders to users whose devices haven't synced recently.</li>
<li><strong>Apple Token Monitor</strong>: Monitor and alert on Apple Push Notification certificate and token expirations.</li></p><p>
</ul><h3>User Management</h3>
<ul><li><strong>Company Attribute Setting</strong>: Set a consistent company attribute across all user accounts in your Microsoft 365 tenant.</li>
<li><strong>Snipe-IT User Sync</strong>: Create or update Snipe-IT users from your Microsoft 365 tenant, using email as the anchor, with secure passwords for new users and optional login/invite toggles.</li></p><p></ul><h3>Third-Party Integration</h3>
<ul><li><strong>Action1 Integration</strong>: Sync Intune device categories to Action1 RMM custom attributes for unified device management across platforms.</li></p><p></ul><h2>Branch Management</h2></p><p>This repository follows a simplified Git workflow:</p><ul><li>The <code>main</code> branch contains stable, production-ready scripts</li>
<li>Development branches are created for new features or significant modifications</li>
<li>Once development work is merged into <code>main</code>, the development branches are typically deleted</li>
<li>For users who have cloned this repository, note that development branches may disappear after their work is completed</li></p><p></ul>If you're working with a specific development branch, consider creating your own fork to ensure your work isn't affected when branches are deleted.</p><h2>What's New in v1.4.0</h2></p><h3>New Runbook: Sync-IntuneToAction1Categories</h3>
This release introduces a new integration with Action1 RMM, enabling automated synchronization of Intune device categories to Action1 custom attributes. Key features include:</p><ul><li>Automatic matching of devices between Intune and Action1 using serial numbers</li>
<li>Syncs Intune device categories to configurable Action1 custom attributes</li>
<li>Supports multiple Action1 regions (North America, Europe, Australia)</li>
<li>Secure credential management through Azure Automation encrypted variables</li>
<li>WhatIf mode for testing without making changes</li>
<li>Comprehensive logging and statistics</li>
<li>Built on the PSAction1 PowerShell module</li></p><p></ul>This integration helps organizations maintain consistent device categorization across both Microsoft Intune and Action1 RMM platforms, enabling better reporting, policy application, and device management workflows.</p><h2>Discussions</h2></p><p>I've enabled GitHub Discussions for this repository to foster collaboration and support among users. This is the best place to:</p><ul><li>Ask questions about implementing specific runbooks</li>
<li>Share your success stories and implementations </li>
<li>Suggest new runbook ideas or improvements</li>
<li>Discuss best practices for Azure Automation</li>
<li>Get help with troubleshooting</li></p><p></ul>Check out the <a href="https://github.com/sargeschultz11/Azure-Runbooks/discussions" target="_blank" rel="noopener noreferrer">Discussions</a> tab to join the conversation. We encourage you to use Discussions for general questions and community interaction, while Issues should be used for reporting bugs or specific problems with the scripts.</p><h2>Contributing</h2></p><p>Feel free to use these scripts as a starting point for your own automation needs. Contributions, improvements, and suggestions are welcome!</p><h2>License</h2></p><p>This project is licensed under the MIT License - see the <a href="LICENSE" target="_blank" rel="noopener noreferrer">LICENSE</a> file for details.

---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-12-06

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/sargeschultz11/Azure-Runbooks/main/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-12-06 
    </div>
    
</body>
</html>