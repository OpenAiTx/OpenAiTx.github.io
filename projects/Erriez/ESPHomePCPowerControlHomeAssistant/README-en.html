<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESPHomePCPowerControlHomeAssistant - ESPHome ESP8266/ESP32 PC Power Control via Home Assistant</title>
    <meta name="description" content="ESPHome ESP8266/ESP32 PC Power Control via Home Assistant">
    <meta name="keywords" content="ESPHomePCPowerControlHomeAssistant, English, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "ESPHomePCPowerControlHomeAssistant",
  "description": "ESPHome ESP8266/ESP32 PC Power Control via Home Assistant",
  "author": {
    "@type": "Person",
    "name": "Erriez"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 329
  },
  "url": "https://OpenAiTx.github.io/projects/Erriez/ESPHomePCPowerControlHomeAssistant/README-en.html",
  "sameAs": "https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/README.md",
  "datePublished": "2025-09-25",
  "dateModified": "2025-09-25"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/Erriez/ESPHomePCPowerControlHomeAssistant" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    ESPHomePCPowerControlHomeAssistant
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 329 stars</span>
                <span class="language">English</span>
                <span>by Erriez</span>
            </div>
        </div>
        
        <div class="content">
            <h1>ESPHome PC Power Control via Home Assistant</h1></p><p>This project contains remote PC power control via HomeAssistant and ESPHome ESP8266/ESP32 boards.</p><p>I use this project to power my PC based NAS remotely on and off via Home Assistant as alternative to Wake-On-Lan (WOL) which has known limitations.</p><h2>Features</h2></p><ul><li>Control physical PC power button (front panel) connected to the motherboard:</li>
  <li>Turn PC power on from any power state such as <code>power-off/suspended/hibernate</code> (Behavior short press power button).</li>
  <li>Graceful <code>shutdown/suspend/hibernate</code> of the operating system (Behavior short press power button).</li>
  <li>Force power-off (Behavior long press power-button).</li>
<li>Read PC power on/off status from motherboard.</li>
<li>No operating system dependency.</li>
<li>Power/reset buttons front panel remains fully functional.</li>
<li>User authorization via Homeassistant.</li>
<li>Use with any (micro/mini)-ATX computer motherboard.</li></p><p></ul>Youtube video:</p><p><a href="https://www.youtube.com/watch?v=rAcvqaPf830" target="_blank" rel="noopener noreferrer"><img src="https://img.youtube.com/vi/rAcvqaPf830/0.jpg" alt="Youtube video"></a></p><p>Homeassistant screenshot:</p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/ScreenshotHomeAssistant.jpg" alt="Screenshot Home Assistant"></p><h2>Differences Wake-On-Lan (WOL) magic packet</h2></p><p><a href="https://en.wikipedia.org/wiki/Wake-on-LAN" target="_blank" rel="noopener noreferrer">Wake-On-Lan (WOL)</a> is intended to turn computer power on remotely via Ethernet by sending a so called <code>magic packet</code>. This has several known limitations which are not applicable with this ESP project:</p><ul><li>Wake-On-Lan (WOL) has <strong>no authorization</strong>! The WOL protocol has no functionality to provide a password or allow a specific computer to wake from. Any device on the same LAN can wake a PC by sending a magic packet. The ESP is password protected via Homeassistant.</li>
<li>Wake-On-Lan (WOL) can only <code>wake</code> a PC from suspend or power-off state. There is no shutdown/suspend functionality. </li>
<li>To put a Linux machine in <code>sleep</code> state, a SSH connection to the remote PC can be made for example by executing <code>pm-suspend</code> command (Install via <code>sudo apt install pm-utils</code>), reference <a href="https://manpages.ubuntu.com/manpages/jammy/man8/pm-action.8.html" target="_blank" rel="noopener noreferrer">Ubuntu pm-action documentation</a>. Disadvantages:</li>
  <li>Requires SSH login.</li>
  <li>Requires sudo rights.</li>
<li>Wake-On-Lan magic packets are ignored when connecting main power the first time to the power supply, even when WOL is activated in the BIOS. The reason is that WOL is disabled on most computers at first power on and requires activation by a running operating system before the PC responds on a magic packet to wake the computer. Reference: <a href="https://help.ubuntu.com/community/WakeOnLan" target="_blank" rel="noopener noreferrer">Ubuntu Wake-On-Lan</a>.</li>
<li>Running Homeassistant <a href="https://www.home-assistant.io/integrations/wake_on_lan" target="_blank" rel="noopener noreferrer">Wake-On-Lan</a> in a Docker container cannot forward broadcast magic packets with a bridged network configuration. It requires an external Docker container as bridge to forward magic packages and is beyond the scope of Homeassistant. This is currently not included in Homeassistant documentation.</li></p><p></ul><h2>Hardware</h2></p><p>The hardware consists of an ESP8266 or ESP32 and two IO pins, mounted on a PCI metal plate (see picture below). In my case I used an ESP8266 NodeMCU board. Theoretically any ESP8266 or ESP32 board can be used for this project.</p><ul><li>One pin controls the power button by generating a long or short press</li>
<li>A second pin reads the motherboard power status.</li></p><p></ul><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/NodeMCU.jpg" alt="Hardware"></p><h2>Schematic</h2></p><p>My NAS is based on an Intel Core I7 ASRock Z97 ATX motherboard and contains standard 2.5mm 2x5 male headers:</p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/Schematic.png" alt="Schematic"></p><p><strong>ATX header USB 2.0:</strong></p><p>Header <code>J1</code> pin 1 constant +5V power on pin 1, even when the PC is power-off and is used to power the NodeMCU. The ESP8266 or ESP32 is powered via an on-board 3V3 regulator.</p><p><strong>ATX header System panel:</strong></p><p>Header <code>J2</code> contains the power, reset and GND pins:</p><ul><li>Power button pin 6.</li>
  <li>Short press: Turn PC on or generate graceful shutdown.</li>
  <li>Long press: Generate hard power off.</li>
<li>Reset button pin 7.</li>
  <li>Used to read power status via the reset button pin:</li>
    <li>High: power-on</li>
    <li>Low: power-off</li>
<li>GND pin 5.</li></p><p><li>Pin <code>D1</code> is used to read the power status from the reset pin: High is on, Low is off. Resistor <code>R1</code> is used to minimize current when the IO pin is accidentally set to output.</li>
<li>Pin <code>D2</code> is used to pull the power button low to generate a short or long press. Transistor <code>Q1</code> is used for secure isolation between ESP8266 and motherboard.</li></p><p></ul>Warning: All ATX and ESP pins must be operating at 3V3.</p><h2>Downloads</h2></p><ul><li><a href="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/kicad/ESP8266-ESPHome-PC-Power-HomeAssistant.pro" target="_blank" rel="noopener noreferrer">KiCad schematic .SCH</a></li></p><p></ul><h2>Wiring</h2></p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/Wiring.jpg" alt="Wiring"></p><p>A DIY breakout PCB can be mounted at the system panel header to connect power button <code>SW1</code> and reset button <code>SW2</code>.</p><h2>WiFi stability</h2></p><p>There is sufficient space in an ATX computer case to mount the ESP board. However, the computer case is metal shielded, so the WiFi distance to the base station reduces. It is recommended to place the ESP outside the computer case when the WiFi connection is unstable or distance too low. An ESP32 may result in different WiFi connection stability, but overall it depends on the environment.</p><p>ESP8266 PCB mounted at the back of the PC case:</p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/ESPMount.jpg" alt="ESP PC mount"></p><h2>Software updates</h2></p><p>The ESPHome application firmware can be updated via USB connection (virtual serial port) or WiFi OTA (Over The Air update).</p><p>Updating the firmware via WiFi is enabled when configuring <code>ota</code> in the .yaml file. This requires a WiFi connection between host computer and ESP. OTA update does not work when the login from ESP to WiFi base station fails due to incorrect WiFi credentials. In this case an update via serial is required or via <code>ap</code> fallback as configured in the .yaml file.</p><h2>ESPHome</h2></p><p>The ESPHome application consists of the two Yaml files. One configuration file and a second <code>secrets.yaml</code> to store passwords.</p><p>Documentation:</p><ul><li><a href="https://esphome.io/components/switch/gpio.html" target="_blank" rel="noopener noreferrer">ESPHome GPIO Switch</a></li>
<li><a href="https://esphome.io/components/binary_sensor/gpio.html" target="_blank" rel="noopener noreferrer">ESPHome Binary Sensor</a></li></p><p></ul><h3>Project configuration</h3></p><p>Configure the following files:
<ul><li><a href="https://github.com/Erriez/ESPHomePCPowerControlHomeAssistant/blob/master/pc-power.yaml" target="_blank" rel="noopener noreferrer">pc-power.yaml</a>: Configure <code>platform</code> and <code>board</code>.</li>
<li><a href="https://github.com/Erriez/ESPHomePCPowerControlHomeAssistant/blob/master/secrets.yaml" target="_blank" rel="noopener noreferrer">secrets.yaml</a>: Configure WiFi SSID and passwords</li></p><p></ul>Please refer to <a href="https://esphome.io/components/esphome.html" target="_blank" rel="noopener noreferrer">ESPHome documentation</a> for more information about ESPHome YAML configuration.</p><h3>Program ESP8266 or ESP32</h3></p><p>Connect USB cable to ESP8266 or ESP32 board and enter the following commands. (Examples are tested on Ubuntu). For more information, refer to <a href="https://esphome.io/guides/getting_started_command_line.html" target="_blank" rel="noopener noreferrer">ESPHome.io</a>.</p><pre><code class="language-bash"># Clone this repository
$ git clone git@github.com:Erriez/ESPHomePCPowerControlHomeAssistant.git</p><h1>Install Python3 virtualenv</h1>
$ sudo apt install python3-virtualenv</p><h1>Create virtualenv</h1>
$ virtualenv venv</p><h1>Activate virtualenv</h1>
$ source venv/bin/activate</p><h1>Install ESPHome</h1>
$ pip install esphome</p><h1>Optional: Install platformio updates</h1>
$ platformio platform update
$ platformio upgrade</p><h1>Optional: Add user permission serial port</h1>
$ sudo usermod -a -G dialout <USERNAME>
$ sudo reboot now</p><h1>Check ESPHome installation</h1>
$ esphome --help</p><h1>Optional: Compile program without upload</h1>
$ esphome compile pc-power.yaml</p><h1>Upload program to ESP8266 or ESP32</h1>
$ esphome run pc-power.yaml</p><h1>Select serial port or WiFi to upload application</h1></p><h1>Check logs</h1>
$ esphome logs pc-power.yaml</code></pre></p><h2>Home Assistant configuration</h2></p><p>This section describes Home Assistant configuration.</p><h3>Register ESP device</h3></p><ul><li><code>Configuration | Integrations: Add Integration: ESPHome</code></li>
<li>Select hostname or IP address of the ESP device.</li>
<li>Enter password as configured in <code>secrets.yml</code> | <code>esphome_api_password</code>.</li></p><p></ul><h3>Homeassistant | Edit Dashboard | RAW Configuration Editor</h3></p><p>Add PC power integration to a dashboard via raw edit:</p><pre><code class="language-yaml">title: Home
views:
  <ul><li>title: PC</li>
    </ul>path: pc
    badges: []
    cards:
      <ul><li>type: button</li>
        </ul>entity: switch.pc_power_toggle
        show_name: true
      <ul><li>type: button</li>
        </ul>tap_action:
          action: none
        entity: binary_sensor.pc_power_state
        hold_action:
          action: none
      <ul><li>type: button</li>
        </ul>tap_action:
          action: toggle
        entity: switch.pc_hard_power_off
        icon_height: 40px
        show_state: false
        show_name: true
        show_icon: true</code></pre></p><h2>Version history</h2></p><p>Restart Home Assistant and ready to go!</p><h3>Update 11 October 2024</h3></p><p>The ESPHome YAML file format changed with <a href="https://esphome.io/changelog/2024.6.0.html#" target="_blank" rel="noopener noreferrer">ESPHome version 2024.6.0</a>. The old format generates errors like:</p><pre><code class="language-">$ esphome compile ESPHomePCPowerControlHomeAssistant/pc-power.yaml
INFO ESPHome 2024.9.2
INFO Reading configuration ESPHomePCPowerControlHomeAssistant/pc-power.yaml...
Failed config</p><p>ota.unknown: [source ESPHomePCPowerControlHomeAssistant/pc-power.yaml:27]</p><p>  'ota' requires a 'platform' key but it was not specified.</p><p>and:</p><p>Failed config</p><p>switch.gpio: [source ESPHomePCPowerControlHomeAssistant/pc-power.yaml:30]</p><p>  Pin 4 is used in multiple places.</code></pre></p><p>In this case, please update to the new file format in this project.</p><h3>Update 13 February 2022</h3></p><ul><li>The button pin timing controlled via Homeassistant scripts was not stable. The power pin control has been moved to the ESP firmware which generates a much more accurate timing.</li>
<li>Renamed the following names:</li>
  <li>Rename <code>switch.pc_power_button</code> to <code>switch.pc_power_toggle</code>.</li>
  <li>Rename <code>switch.pc_power_button_long_press</code> to <code>switch.pc_hard_power_off</code>.</li>
  <li>Rename <code>switch.pc_power_sense</code> to <code>switch.pc_power_state</code>.</li></p><p>
</ul>---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-09-25

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-09-25 
    </div>
    
</body>
</html>