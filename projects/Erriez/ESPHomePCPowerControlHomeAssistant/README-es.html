<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESPHomePCPowerControlHomeAssistant - ESPHome ESP8266/ESP32 Control de energ&#237;a de PC v&#237;a Home Assistant</title>
    <meta name="description" content="ESPHome ESP8266/ESP32 Control de energ&#237;a de PC v&#237;a Home Assistant">
    <meta name="keywords" content="ESPHomePCPowerControlHomeAssistant, Spanish, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "ESPHomePCPowerControlHomeAssistant",
  "description": "ESPHome ESP8266/ESP32 Control de energía de PC vía Home Assistant",
  "author": {
    "@type": "Person",
    "name": "Erriez"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 329
  },
  "url": "https://OpenAiTx.github.io/projects/Erriez/ESPHomePCPowerControlHomeAssistant/README-es.html",
  "sameAs": "https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/README.md",
  "datePublished": "2025-09-25",
  "dateModified": "2025-09-25"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/Erriez/ESPHomePCPowerControlHomeAssistant" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    ESPHomePCPowerControlHomeAssistant
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 329 stars</span>
                <span class="language">Spanish</span>
                <span>by Erriez</span>
            </div>
        </div>
        
        <div class="content">
            <h1>Control de Encendido de PC con ESPHome vía Home Assistant</h1></p><p>Este proyecto contiene control remoto del encendido de PC vía HomeAssistant y placas ESPHome ESP8266/ESP32.</p><p>Uso este proyecto para encender y apagar remotamente mi NAS basado en PC vía Home Assistant como alternativa a Wake-On-Lan (WOL) que tiene limitaciones conocidas.</p><h2>Características</h2></p><ul><li>Control del botón físico de encendido del PC (panel frontal) conectado a la placa base:</li>
  <li>Encender el PC desde cualquier estado de energía como <code>apagado/suspendido/hibernación</code> (Comportamiento de pulsación corta del botón de encendido).</li>
  <li>Apagado/suspensión/hibernación ordenado del sistema operativo (Comportamiento de pulsación corta del botón de encendido).</li>
  <li>Apagado forzado (Comportamiento de pulsación larga del botón de encendido).</li>
<li>Leer el estado de encendido/apagado del PC desde la placa base.</li>
<li>Sin dependencia del sistema operativo.</li>
<li>Los botones de encendido/reset del panel frontal permanecen totalmente funcionales.</li>
<li>Autorización de usuario vía Homeassistant.</li>
<li>Uso con cualquier placa base (micro/mini)-ATX.</li></p><p></ul>Video de Youtube:</p><p><a href="https://www.youtube.com/watch?v=rAcvqaPf830" target="_blank" rel="noopener noreferrer"><img src="https://img.youtube.com/vi/rAcvqaPf830/0.jpg" alt="Video de Youtube"></a></p><p>Captura de pantalla de Homeassistant:</p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/ScreenshotHomeAssistant.jpg" alt="Captura de pantalla Home Assistant"></p><h2>Diferencias con el paquete mágico Wake-On-Lan (WOL)</h2></p><p><a href="https://es.wikipedia.org/wiki/Wake-on-LAN" target="_blank" rel="noopener noreferrer">Wake-On-Lan (WOL)</a> está diseñado para encender la energía del ordenador remotamente vía Ethernet enviando un llamado <code>paquete mágico</code>. Esto tiene varias limitaciones conocidas que no aplican con este proyecto ESP:</p><ul><li>Wake-On-Lan (WOL) <strong>no tiene autorización</strong>! El protocolo WOL no tiene funcionalidad para proveer contraseña ni permitir que un equipo específico despierte el PC. Cualquier dispositivo en la misma LAN puede despertar un PC enviando un paquete mágico. El ESP está protegido con contraseña vía Homeassistant.</li>
<li>Wake-On-Lan (WOL) solo puede <code>despertar</code> un PC desde estado suspendido o apagado. No hay funcionalidad para apagar/suspender.</li>
<li>Para poner una máquina Linux en estado de <code>suspensión</code>, se puede hacer una conexión SSH al PC remoto, por ejemplo ejecutando el comando <code>pm-suspend</code> (Instalar vía <code>sudo apt install pm-utils</code>), referencia <a href="https://manpages.ubuntu.com/manpages/jammy/man8/pm-action.8.html" target="_blank" rel="noopener noreferrer">documentación Ubuntu pm-action</a>. Desventajas:</li>
  <li>Requiere inicio de sesión SSH.</li>
  <li>Requiere derechos sudo.</li>
<li>Los paquetes mágicos Wake-On-Lan son ignorados al conectar la fuente de alimentación por primera vez, incluso cuando WOL está activado en la BIOS. La razón es que WOL está desactivado en la mayoría de los ordenadores al primer encendido y requiere activación por un sistema operativo en ejecución antes de que el PC responda a un paquete mágico para despertar el equipo. Referencia: <a href="https://help.ubuntu.com/community/WakeOnLan" target="_blank" rel="noopener noreferrer">Ubuntu Wake-On-Lan</a>.</li>
<li>Ejecutar Wake-On-Lan de Homeassistant <a href="https://www.home-assistant.io/integrations/wake_on_lan" target="_blank" rel="noopener noreferrer">Wake-On-Lan</a> en un contenedor Docker no puede reenviar paquetes mágicos broadcast con una configuración de red en puente. Requiere un contenedor Docker externo como puente para reenviar paquetes mágicos y está fuera del alcance de Homeassistant. Actualmente esto no está incluido en la documentación de Homeassistant.</li></p><p></ul><h2>Hardware</h2></p><p>El hardware consiste en un ESP8266 o ESP32 y dos pines IO, montados en una placa metálica PCI (ver imagen abajo). En mi caso utilicé una placa ESP8266 NodeMCU. Teóricamente, cualquier placa ESP8266 o ESP32 puede usarse para este proyecto.</p><ul><li>Un pin controla el botón de encendido generando una pulsación larga o corta</li>
<li>Un segundo pin lee el estado de encendido de la placa base.</li></p><p></ul><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/NodeMCU.jpg" alt="Hardware"></p><h2>Esquemático</h2></p><p>Mi NAS está basado en una placa base Intel Core I7 ASRock Z97 ATX y contiene conectores macho estándar 2.5mm 2x5:</p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/Schematic.png" alt="Esquemático"></p><p><strong>Conector ATX USB 2.0:</strong></p><p>El pin 1 del conector <code>J1</code> es alimentación constante +5V en el pin 1, incluso cuando el PC está apagado y se usa para alimentar el NodeMCU. El ESP8266 o ESP32 se alimenta a través de un regulador 3V3 integrado en la placa.</p><p><strong>Conector ATX Panel del sistema:</strong></p><p>El conector <code>J2</code> contiene los pines de encendido, reset y GND:</p><ul><li>Pin 6 del botón de encendido.</li>
  <li>Pulsación corta: Enciende el PC o genera un apagado ordenado.</li>
  <li>Pulsación larga: Genera un apagado forzado.</li>
<li>Pin 7 del botón de reset.</li>
  <li>Se usa para leer el estado de encendido mediante el pin del botón reset:</li>
    <li>Alto: encendido</li>
    <li>Bajo: apagado</li>
<li>Pin 5 GND.</li></p><p><li>El pin <code>D1</code> se usa para leer el estado de encendido desde el pin de reset: Alto es encendido, Bajo es apagado. La resistencia <code>R1</code> se usa para minimizar la corriente cuando el pin IO se configura accidentalmente como salida.</li>
<li>El pin <code>D2</code> se usa para poner el botón de encendido a nivel bajo para generar una pulsación corta o larga. El transistor <code>Q1</code> se usa para un aislamiento seguro entre el ESP8266 y la placa base.</li></p><p></ul>Advertencia: Todos los pines ATX y ESP deben operar a 3V3.</p><h2>Descargas</h2></p><ul><li><a href="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/kicad/ESP8266-ESPHome-PC-Power-HomeAssistant.pro" target="_blank" rel="noopener noreferrer">Esquemático KiCad .SCH</a></li></p><p></ul><h2>Cableado</h2></p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/Wiring.jpg" alt="Wiring"></p><p>Se puede montar una PCB DIY de breakout en el conector del panel del sistema para conectar el botón de encendido <code>SW1</code> y el botón de reinicio <code>SW2</code>.</p><h2>Estabilidad de WiFi</h2></p><p>Hay suficiente espacio en una caja de computadora ATX para montar la placa ESP. Sin embargo, la caja de la computadora está protegida con metal, por lo que la distancia del WiFi a la estación base se reduce. Se recomienda colocar el ESP fuera de la caja de la computadora cuando la conexión WiFi sea inestable o la distancia sea demasiado baja. Un ESP32 puede resultar en una estabilidad de conexión WiFi diferente, pero en general depende del entorno.</p><p>PCB ESP8266 montada en la parte trasera de la caja del PC:</p><p><img src="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/images/ESPMount.jpg" alt="ESP PC mount"></p><h2>Actualizaciones de software</h2></p><p>El firmware de la aplicación ESPHome se puede actualizar vía conexión USB (puerto serial virtual) o por WiFi OTA (actualización Over The Air).</p><p>La actualización del firmware vía WiFi se habilita configurando <code>ota</code> en el archivo .yaml. Esto requiere una conexión WiFi entre el computador anfitrión y el ESP. La actualización OTA no funciona cuando el inicio de sesión del ESP a la estación base WiFi falla debido a credenciales WiFi incorrectas. En este caso, se requiere una actualización por serial o vía fallback <code>ap</code> como está configurado en el archivo .yaml.</p><h2>ESPHome</h2></p><p>La aplicación ESPHome consta de dos archivos Yaml. Un archivo de configuración y un segundo <code>secrets.yaml</code> para almacenar contraseñas.</p><p>Documentación:</p><ul><li><a href="https://esphome.io/components/switch/gpio.html" target="_blank" rel="noopener noreferrer">ESPHome GPIO Switch</a></li>
<li><a href="https://esphome.io/components/binary_sensor/gpio.html" target="_blank" rel="noopener noreferrer">ESPHome Binary Sensor</a></li></p><p></ul><h3>Configuración del proyecto</h3></p><p>Configure los siguientes archivos:
<ul><li><a href="https://github.com/Erriez/ESPHomePCPowerControlHomeAssistant/blob/master/pc-power.yaml" target="_blank" rel="noopener noreferrer">pc-power.yaml</a>: Configure <code>platform</code> y <code>board</code>.</li>
<li><a href="https://github.com/Erriez/ESPHomePCPowerControlHomeAssistant/blob/master/secrets.yaml" target="_blank" rel="noopener noreferrer">secrets.yaml</a>: Configure el SSID y las contraseñas de WiFi.</li></p><p></ul>Por favor, consulte la <a href="https://esphome.io/components/esphome.html" target="_blank" rel="noopener noreferrer">documentación de ESPHome</a> para más información sobre la configuración YAML de ESPHome.</p><h3>Programar ESP8266 o ESP32</h3></p><p>Conecte el cable USB a la placa ESP8266 o ESP32 y ejecute los siguientes comandos. (Los ejemplos se probaron en Ubuntu). Para más información, consulte <a href="https://esphome.io/guides/getting_started_command_line.html" target="_blank" rel="noopener noreferrer">ESPHome.io</a>.</p><pre><code class="language-bash"># Clone this repository
$ git clone git@github.com:Erriez/ESPHomePCPowerControlHomeAssistant.git</p><h1>Install Python3 virtualenv</h1>
$ sudo apt install python3-virtualenv</p><h1>Create virtualenv</h1>
$ virtualenv venv</p><h1>Activate virtualenv</h1>
$ source venv/bin/activate</p><h1>Install ESPHome</h1>
$ pip install esphome</p><h1>Optional: Install platformio updates</h1>
$ platformio platform update
$ platformio upgrade</p><h1>Optional: Add user permission serial port</h1>
$ sudo usermod -a -G dialout <USERNAME>
$ sudo reboot now</p><h1>Check ESPHome installation</h1>
$ esphome --help</p><h1>Optional: Compile program without upload</h1>
$ esphome compile pc-power.yaml</p><h1>Upload program to ESP8266 or ESP32</h1>
$ esphome run pc-power.yaml</p><h1>Select serial port or WiFi to upload application</h1></p><h1>Check logs</h1>
$ esphome logs pc-power.yaml</code></pre></p><h2>Configuración de Home Assistant</h2></p><p>Esta sección describe la configuración de Home Assistant.</p><h3>Registrar dispositivo ESP</h3></p><ul><li><code>Configuración | Integraciones: Añadir Integración: ESPHome</code></li>
<li>Seleccione el nombre de host o la dirección IP del dispositivo ESP.</li>
<li>Ingrese la contraseña configurada en <code>secrets.yml</code> | <code>esphome_api_password</code>.</li></p><p></ul><h3>Homeassistant | Editar Panel | Editor de Configuración RAW</h3></p><p>Agregue la integración de energía del PC a un panel mediante edición RAW:</p><pre><code class="language-yaml">title: Home
views:
  <ul><li>title: PC</li>
    </ul>path: pc
    badges: []
    cards:
      <ul><li>type: button</li>
        </ul>entity: switch.pc_power_toggle
        show_name: true
      <ul><li>type: button</li>
        </ul>tap_action:
          action: none
        entity: binary_sensor.pc_power_state
        hold_action:
          action: none
      <ul><li>type: button</li>
        </ul>tap_action:
          action: toggle
        entity: switch.pc_hard_power_off
        icon_height: 40px
        show_state: false
        show_name: true
        show_icon: true</code></pre></p><h2>Historial de versiones</h2></p><p>¡Reinicie Home Assistant y listo para usar!</p><h3>Actualización 11 de octubre de 2024</h3></p><p>El formato del archivo YAML de ESPHome cambió con <a href="https://esphome.io/changelog/2024.6.0.html#" target="_blank" rel="noopener noreferrer">ESPHome versión 2024.6.0</a>. El formato antiguo genera errores como:</p><pre><code class="language-">$ esphome compile ESPHomePCPowerControlHomeAssistant/pc-power.yaml
INFO ESPHome 2024.9.2
INFO Reading configuration ESPHomePCPowerControlHomeAssistant/pc-power.yaml...
Failed config</p><p>ota.unknown: [source ESPHomePCPowerControlHomeAssistant/pc-power.yaml:27]</p><p>  'ota' requires a 'platform' key but it was not specified.</p><p>and:</p><p>Failed config</p><p>switch.gpio: [source ESPHomePCPowerControlHomeAssistant/pc-power.yaml:30]</p><p>  Pin 4 is used in multiple places.</code></pre></p><p>En este caso, actualice al nuevo formato de archivo en este proyecto.</p><h3>Actualización 13 de febrero de 2022</h3></p><ul><li>El tiempo del pin del botón controlado mediante scripts de Homeassistant no era estable. El control del pin de alimentación se ha trasladado al firmware ESP, que genera un tiempo mucho más preciso.</li>
<li>Renombrados los siguientes nombres:</li>
  <li>Renombrar <code>switch.pc_power_button</code> a <code>switch.pc_power_toggle</code>.</li>
  <li>Renombrar <code>switch.pc_power_button_long_press</code> a <code>switch.pc_hard_power_off</code>.</li>
  <li>Renombrar <code>switch.pc_power_sense</code> a <code>switch.pc_power_state</code>.</li></p><p>
</ul>---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-09-25

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/Erriez/ESPHomePCPowerControlHomeAssistant/master/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-09-25 
    </div>
    
</body>
</html>