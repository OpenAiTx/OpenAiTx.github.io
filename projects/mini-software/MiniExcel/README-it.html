<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniExcel - Helper Excel .NET veloce, a basso consumo di memoria e facile da usare per importare/esportare/modellare fogli di calcolo (supporta Linux, Mac)</title>
    <meta name="description" content="Helper Excel .NET veloce, a basso consumo di memoria e facile da usare per importare/esportare/modellare fogli di calcolo (supporta Linux, Mac)">
    <meta name="keywords" content="MiniExcel, Italian, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "MiniExcel",
  "description": "Helper Excel .NET veloce, a basso consumo di memoria e facile da usare per importare/esportare/modellare fogli di calcolo (supporta Linux, Mac)",
  "author": {
    "@type": "Person",
    "name": "mini-software"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 3374
  },
  "url": "https://OpenAiTx.github.io/projects/mini-software/MiniExcel/README-it.html",
  "sameAs": "https://raw.githubusercontent.com/mini-software/MiniExcel/master/README.md",
  "datePublished": "2026-03-01",
  "dateModified": "2026-03-01"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/mini-software/MiniExcel" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    MiniExcel
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 3374 stars</span>
                <span class="language">Italian</span>
                <span>by mini-software</span>
            </div>
        </div>
        
        <div class="content">
            <p><div align="center">
<p><a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/nuget/v/MiniExcel.svg" alt="NuGet"></a>  <a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/nuget/dt/MiniExcel.svg" alt=""></a>
<a href="https://ci.appveyor.com/project/mini-software/miniexcel/branch/master"><img src="https://ci.appveyor.com/api/projects/status/b2vustrwsuqx45f4/branch/master?svg=true" alt="Stato Build"></a>
<a href="https://gitee.com/dotnetchina/MiniExcel"><img src="https://gitee.com/dotnetchina/MiniExcel/badge/star.svg" alt="stella"></a> <a href="https://github.com/mini-software/MiniExcel" rel="nofollow"><img src="https://img.shields.io/github/stars/mini-software/MiniExcel?logo=github" alt="Stelle GitHub"></a>
<a href="https://www.nuget.org/packages/MiniExcel"><img src="https://img.shields.io/badge/.NET-%3E%3D%204.5-red.svg" alt="versione"></a>
<a href="https://deepwiki.com/mini-software/MiniExcel"><img src="https://deepwiki.com/badge.svg" alt="Chiedi a DeepWiki"></a>
</p>
</div></p><hr></p><p><a href="https://www.dotnetfoundation.org/" target="_blank" rel="noopener noreferrer"><img align="right" src="https://github.com/dotnet-foundation/swag/blob/main/logo/dotnetfoundation_v4.png?raw=true" width="100" /></a></p><p><div align="center">
<p>Questo progetto fa parte della <a href="https://www.dotnetfoundation.org/">.NET Foundation</a> e opera secondo il loro <a href="https://www.dotnetfoundation.org/code-of-conduct">codice di condotta</a>. </p>
</div></p><hr></p><p><div align="center">
<p><strong><a href="README.md">English</a> | <a href="README.zh-CN.md">简体中文</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=zh-TW">繁體中文</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ja">日本語</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ko">한국어</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=hi">हिन्दी</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=th">ไทย</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=fr">Français</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=de">Deutsch</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=es">Español</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=it">Italiano</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ru">Русский</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=pt">Português</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=nl">Nederlands</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=pl">Polski</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=ar">العربية</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=fa">فارسی</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=tr">Türkçe</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=vi">Tiếng Việt</a> | <a href="https://openaitx.github.io/view.html?user=mini-software&amp;project=MiniExcel&amp;lang=id">Bahasa Indonesia</a>
</strong></p>
</div></p><hr></p><p><div align="center">
 Le tue <a href="https://github.com/mini-software/MiniExcel">Stelle</a> o le <a href="https://miniexcel.github.io">Donazioni</a> possono rendere MiniExcel migliore
</div></p><hr></p><h3>Introduzione</h3></p><p>MiniExcel è uno strumento semplice ed efficiente per la gestione di file Excel su .NET, progettato specificamente per minimizzare l’utilizzo della memoria.</p><p>Attualmente, la maggior parte dei framework popolari necessita di caricare tutti i dati da un documento Excel in memoria per facilitarne le operazioni, ma questo può causare problemi di consumo di memoria. L’approccio di MiniExcel è diverso: i dati vengono elaborati riga per riga in modalità streaming, riducendo il consumo originale da centinaia di megabyte a pochi megabyte, prevenendo efficacemente i problemi di esaurimento memoria (OOM).</p><pre><code class="language-mermaid">flowchart LR
    A1(["Excel analysis<br>process"]) --> A2{{"Unzipping<br>XLSX file"}} --> A3{{"Parsing<br>OpenXML"}} --> A4{{"Model<br>conversion"}} --> A5(["Output"])</p><p>    B1(["Other Excel<br>Frameworks"]) --> B2{{"Memory"}} --> B3{{"Memory"}} --> B4{{"Workbooks &<br>Worksheets"}} --> B5(["All rows at<br>the same time"])</p><p>    C1(["MiniExcel"]) --> C2{{"Stream"}} --> C3{{"Stream"}} --> C4{{"POCO or dynamic"}} --> C5(["Deferred execution<br>row by row"])</p><p>    classDef analysis fill:#D0E8FF,stroke:#1E88E5,color:#0D47A1,font-weight:bold;
    classDef others fill:#FCE4EC,stroke:#EC407A,color:#880E4F,font-weight:bold;
    classDef miniexcel fill:#E8F5E9,stroke:#388E3C,color:#1B5E20,font-weight:bold;</p><p>    class A1,A2,A3,A4,A5 analysis;
    class B1,B2,B3,B4,B5 others;
    class C1,C2,C3,C4,C5 miniexcel;</code></pre></p><h3>Funzionalità</h3></p><ul><li>Minimizza il consumo di memoria, prevenendo errori di memoria insufficiente (OOM) ed evitando garbage collection complete</li>
<li>Abilita operazioni in tempo reale a livello di riga per migliori prestazioni su grandi set di dati</li>
<li>Supporta LINQ con esecuzione differita, permettendo paginazione veloce ed efficiente in termini di memoria e query complesse</li>
<li>Leggero, senza necessità di Microsoft Office o componenti COM+, e una DLL inferiore a 500KB</li>
<li>API semplice e intuitiva per leggere/scrivere/riempire excel</li></p><p></ul><h3>Anteprima versione 2.0</h3></p><p>Stiamo lavorando su una futura versione di MiniExcel, con una nuova API modulare e focalizzata,
pacchetti nuget separati per le funzionalità Core e Csv, pieno supporto per query asincrone tramite <code>IAsyncEnumerable</code>,
e altre novità in arrivo! I pacchetti saranno disponibili in pre-release, quindi sentitevi liberi di provarli e darci un feedback!</p><p>Se lo fate, assicuratevi anche di consultare la <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/README-V2.md" target="_blank" rel="noopener noreferrer">nuova documentazione</a> e le <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/V2-Upgrade-Notes.md" target="_blank" rel="noopener noreferrer">note di aggiornamento</a>.</p><h3>Inizia subito</h3></p><ul><li><a href="#getstart1" target="_blank" rel="noopener noreferrer">Importa/Interroga Excel</a></li></p><p><li><a href="#getstart2" target="_blank" rel="noopener noreferrer">Esporta/Crea Excel</a></li></p><p><li><a href="#getstart3" target="_blank" rel="noopener noreferrer">Template Excel</a></li></p><p><li><a href="#getstart4" target="_blank" rel="noopener noreferrer">Nome/Indice/Attributo Ignora Colonna Excel</a></li></p><p><li><a href="#getstart5" target="_blank" rel="noopener noreferrer">Esempi</a></li></p><p>
</ul><h3>Installazione</h3></p><p>Puoi installare il pacchetto <a href="https://www.nuget.org/packages/MiniExcel" target="_blank" rel="noopener noreferrer">da NuGet</a></p><h3>Note di rilascio</h3></p><p>Controlla le <a href="docs" target="_blank" rel="noopener noreferrer">Note di Rilascio</a></p><h3>TODO</h3></p><p>Si prega di controllare <a href="https://github.com/mini-software/MiniExcel/projects/1?fullscreen=true" target="_blank" rel="noopener noreferrer">TODO</a></p><h3>Prestazioni</h3></p><p>Il codice per i benchmark si trova in <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/benchmarks/MiniExcel.Benchmarks/Program.cs" target="_blank" rel="noopener noreferrer">MiniExcel.Benchmarks</a>.</p><p>Il file utilizzato per testare le prestazioni è <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/benchmarks/MiniExcel.Benchmarks/Test1%2C000%2C000x10.xlsx" target="_blank" rel="noopener noreferrer"><strong>Test1,000,000x10.xlsx</strong></a>, un documento da 32MB contenente 1.000.000 righe * 10 colonne le cui celle sono riempite con la stringa "HelloWorld".</p><p>Per eseguire tutti i benchmark utilizzare:</p><pre><code class="language-bash">dotnet run -project .\benchmarks\MiniExcel.Benchmarks -c Release -f net9.0 -filter * --join</code></pre>
Puoi trovare i risultati dei benchmark per l'ultima release <a href="benchmarks/results" target="_blank" rel="noopener noreferrer">qui</a>.</p><h3>Query/Importazione Excel  <a name="getstart1"></a></h3></p><p>#### 1. Esegui una query e mappa i risultati su un IEnumerable fortemente tipizzato [[Provalo]](https://dotnetfiddle.net/w5WD1J)</p><p>Si consiglia di utilizzare Stream.Query per una maggiore efficienza.</p><pre><code class="language-csharp">public class UserAccount
{
    public Guid ID { get; set; }
    public string Name { get; set; }
    public DateTime BoD { get; set; }
    public int Age { get; set; }
    public bool VIP { get; set; }
    public decimal Points { get; set; }
}</p><p>var rows = MiniExcel.Query<UserAccount>(path);</p><p>// or</p><p>using (var stream = File.OpenRead(path))
    var rows = stream.Query<UserAccount>();</code></pre>
<img src="https://user-images.githubusercontent.com/12729184/111107423-c8c46b80-8591-11eb-982f-c97a2dafb379.png" alt="image"></p><p>#### 2. Esegui una query e mappala su una lista di oggetti dinamici senza usare head [[Provalo]](https://dotnetfiddle.net/w5WD1J)</p><ul><li>la chiave dinamica è <code>A.B.C.D..</code></li></p><p></ul>| MiniExcel | 1 |
|-----------|---|
| Github    | 2 |</p><pre><code class="language-csharp">
var rows = MiniExcel.Query(path).ToList();</p><p>// or
using (var stream = File.OpenRead(path))
{
    var rows = stream.Query().ToList();</p><p>    Assert.Equal("MiniExcel", rows[0].A);
    Assert.Equal(1, rows[0].B);
    Assert.Equal("Github", rows[1].A);
    Assert.Equal(2, rows[1].B);
}</code></pre>
#### 3. Esegui una query con la prima riga di intestazione [[Provalo]](https://dotnetfiddle.net/w5WD1J)</p><p>nota : se ci sono colonne con lo stesso nome viene utilizzata l’ultima a destra</p><p>Excel di input :</p><p>| Colonna1   | Colonna2 |
|------------|----------|
| MiniExcel  | 1        |
| Github     | 2        |</p><pre><code class="language-csharp">
var rows = MiniExcel.Query(useHeaderRow:true).ToList();</p><p>// or</p><p>using (var stream = File.OpenRead(path))
{
    var rows = stream.Query(useHeaderRow:true).ToList();</p><p>    Assert.Equal("MiniExcel", rows[0].Column1);
    Assert.Equal(1, rows[0].Column2);
    Assert.Equal("Github", rows[1].Column1);
    Assert.Equal(2, rows[1].Column2);
}</code></pre>
#### 4. Estensione LINQ per il supporto alle query First/Take/Skip ...ecc.</p><p>Query First</p><pre><code class="language-csharp">var row = MiniExcel.Query(path).First();
Assert.Equal("HelloWorld", row.A);</p><p>// or</p><p>using (var stream = File.OpenRead(path))
{
    var row = stream.Query().First();
    Assert.Equal("HelloWorld", row.A);
}</code></pre>
Prestazioni tra MiniExcel/ExcelDataReader/ClosedXML/EPPlus
<img src="https://user-images.githubusercontent.com/12729184/111072392-6037a900-8515-11eb-9693-5ce2dad1e460.gif" alt="queryfirst"></p><p>#### 5. Query per nome del foglio</p><pre><code class="language-csharp">MiniExcel.Query(path, sheetName: "SheetName");
//or
stream.Query(sheetName: "SheetName");</code></pre>
#### 6. Interrogare tutti i nomi dei fogli e le righe</p><pre><code class="language-csharp">var sheetNames = MiniExcel.GetSheetNames(path);
foreach (var sheetName in sheetNames)
{
    var rows = MiniExcel.Query(path, sheetName: sheetName);
}</code></pre>
#### 7. Ottieni Colonne</p><pre><code class="language-csharp">var columns = MiniExcel.GetColumns(path); // e.g result : ["A","B"...]</p><p>var cnt = columns.Count;  // get column count</code></pre>
#### 8. Query dinamica: cast della riga a <code>IDictionary<string,object></code></p><pre><code class="language-csharp">foreach(IDictionary<string,object> row in MiniExcel.Query(path))
{
    //..
}</p><p>// or
var rows = MiniExcel.Query(path).Cast<IDictionary<string,object>>();
// or Query specified ranges (capitalized)
// A2 represents the second row of column A, C3 represents the third row of column C
// If you don't want to restrict rows, just don't include numbers
var rows = MiniExcel.QueryRange(path, startCell: "A2", endCell: "C3").Cast<IDictionary<string, object>>();</code></pre>
#### 9. Query Excel restituisce DataTable</p><p>Non consigliato, perché DataTable caricherà tutti i dati in memoria e perderà la caratteristica di basso consumo di memoria di MiniExcel.</p><p>
``<code>C#
var table = MiniExcel.QueryAsDataTable(path, useHeaderRow: true);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/116673475-07917200-a9d6-11eb-947e-a6f68cce58df.png" alt="image"></p><p>#### 10. Specificare la cella da cui iniziare a leggere i dati</p><p></code></pre>csharp
MiniExcel.Query(path,useHeaderRow:true,startCell:"B3")
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/117260316-8593c400-ae81-11eb-9877-c087b7ac2b01.png" alt="image"></p><p>#### 11. Compilare Celle Unite</p><p>Nota: L'efficienza è più lenta rispetto a </code>non utilizzare il riempimento unione<code></p><p>Motivo: Lo standard OpenXml mette mergeCells in fondo al file, il che porta alla necessità di eseguire due foreach sul sheetxml</p><p></code></pre>csharp
    var config = new OpenXmlConfiguration()
    {
        FillMergedCells = true
    };
    var rows = MiniExcel.Query(path, configuration: config);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/117973630-3527d500-b35f-11eb-95c3-bde255f8114e.png" alt="image"></p><p>supporta il riempimento multi-riga e multi-colonna con lunghezza e larghezza variabili</p><p><img src="https://user-images.githubusercontent.com/12729184/117973820-6d2f1800-b35f-11eb-88d8-555063938108.png" alt="image"></p><p>#### 12. Lettura di grandi file tramite cache su disco (Disk-Base Cache - SharedString)</p><p>Se la dimensione di SharedStrings supera i 5 MB, MiniExcel utilizzerà di default la cache su disco locale, ad esempio, <a href="https://github.com/MiniExcel/MiniExcel/files/8403819/NotDuplicateSharedStrings_10x100000.xlsx" target="_blank" rel="noopener noreferrer">10x100000.xlsx</a> (un milione di righe di dati), quando la cache su disco è disabilitata l'utilizzo massimo di memoria è 195MB, ma abilitando la cache su disco servono solo 65MB. Nota, questa ottimizzazione comporta un piccolo costo in termini di efficienza, quindi in questo caso il tempo di lettura aumenta da 7,4 secondi a 27,2 secondi. Se non ne hai bisogno puoi disabilitare la cache su disco con il seguente codice:</p><p></code></pre>csharp
var config = new OpenXmlConfiguration { EnableSharedStringCache = false };
MiniExcel.Query(path,configuration: config)
<pre><code class="language-">Puoi usare </code>SharedStringCacheSize<code> per modificare la dimensione del file sharedString oltre la dimensione specificata per la cache su disco
</code></pre>csharp
var config = new OpenXmlConfiguration { SharedStringCacheSize=500<em>1024</em>1024 };
MiniExcel.Query(path, configuration: config);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/161411851-1c3f72a7-33b3-4944-84dc-ffc1d16747dd.png" alt="image"></p><p><img src="https://user-images.githubusercontent.com/12729184/161411825-17f53ec7-bef4-4b16-b234-e24799ea41b0.png" alt="image"></p><h3>Creare/Esportare Excel  <a name="getstart2"></a></h3></p><ul><li>Deve essere un tipo non astratto con un costruttore pubblico senza parametri.</li></p><p><li>MiniExcel supporta l'esecuzione differita tramite IEnumerable; se desideri utilizzare meno memoria, per favore non chiamare metodi come ToList</li></p><p></ul>esempio: uso di memoria con o senza ToList
<img src="https://user-images.githubusercontent.com/12729184/112587389-752b0b00-8e38-11eb-8a52-cfb76c57e5eb.png" alt="image"></p><p>#### 1. Tipo anonimo o fortemente tipizzato [[Provalo]](https://dotnetfiddle.net/w5WD1J)</p><p>
</code></pre>csharp
var path = Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid()}.xlsx");
MiniExcel.SaveAs(path, new[] {
    new { Column1 = "MiniExcel", Column2 = 1 },
    new { Column1 = "Github", Column2 = 2}
});
<pre><code class="language-">#### 2. </code>IEnumerable<IDictionary<string, object>><code></p><p></code></pre>csharp
var values = new List<Dictionary<string, object>>()
{
    new Dictionary<string,object>{{ "Column1", "MiniExcel" }, { "Column2", 1 } },
    new Dictionary<string,object>{{ "Column1", "Github" }, { "Column2", 2 } }
};
MiniExcel.SaveAs(path, values);
<pre><code class="language-">Crea Risultato File :</p><p>| Colonna1  | Colonna2 |
|-----------|----------|
| MiniExcel | 1        |
| Github    | 2        |</p><p>
#### 3.  IDataReader
<ul><li></code>Raccomandato<code>, può evitare di caricare tutti i dati in memoria</li>
</ul></code></pre>csharp
MiniExcel.SaveAs(path, reader);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/121275378-149a5e80-c8bc-11eb-85fe-5453552134f0.png" alt="image"></p><p>Esportazione di più fogli con DataReader (consigliato da Dapper ExecuteReader)</p><p></code></pre>csharp
using (var cnn = Connection)
{
    cnn.Open();
    var sheets = new Dictionary<string,object>();
    sheets.Add("sheet1", cnn.ExecuteReader("select 1 id"));
    sheets.Add("sheet2", cnn.ExecuteReader("select 2 id"));
    MiniExcel.SaveAs("Demo.xlsx", sheets);
}
<pre><code class="language-">#### 4. Datatable</p><ul><li></code>Non raccomandato<code>, caricherà tutti i dati in memoria</li></p><p><li>DataTable usa Caption come primo nome della colonna, poi usa columname</li></p><p></ul></code></pre>csharp
var path = Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid()}.xlsx");
var table = new DataTable();
{
    table.Columns.Add("Column1", typeof(string));
    table.Columns.Add("Column2", typeof(decimal));
    table.Rows.Add("MiniExcel", 1);
    table.Rows.Add("Github", 2);
}</p><p>MiniExcel.SaveAs(path, table);
<pre><code class="language-">#### 5. Query Dapper</p><p>Grazie @shaofing #552, si prega di utilizzare </code>CommandDefinition + CommandFlags.NoCache<code></p><p></code></pre>csharp
using (var connection = GetConnection(connectionString))
{
    var rows = connection.Query(
        new CommandDefinition(
            @"select 'MiniExcel' as Column1,1 as Column2 union all select 'Github',2"
            , flags: CommandFlags.NoCache)
        );
    // Note: QueryAsync will throw close connection exception
    MiniExcel.SaveAs(path, rows);
}
<pre><code class="language-">Il codice seguente caricherà tutti i dati in memoria</p><p></code></pre>csharp
using (var connection = GetConnection(connectionString))
{
    var rows = connection.Query(@"select 'MiniExcel' as Column1,1 as Column2 union all select 'Github',2");
    MiniExcel.SaveAs(path, rows);
}
<pre><code class="language-">#### 6. SaveAs su MemoryStream  [[Provalo]](https://dotnetfiddle.net/JOen0e)</p><p>
</code></pre>csharp
using (var stream = new MemoryStream()) //support FileStream,MemoryStream ect.
{
    stream.SaveAs(values);
}
<pre><code class="language-">ad es.: api per l'esportazione in excel</p><p></code></pre>csharp
public IActionResult DownloadExcel()
{
    var values = new[] {
        new { Column1 = "MiniExcel", Column2 = 1 },
        new { Column1 = "Github", Column2 = 2}
    };</p><p>    var memoryStream = new MemoryStream();
    memoryStream.SaveAs(values);
    memoryStream.Seek(0, SeekOrigin.Begin);
    return new FileStreamResult(memoryStream, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
    {
        FileDownloadName = "demo.xlsx"
    };
}
<pre><code class="language-">#### 7. Creare più fogli</p><p>
</code></pre>csharp
// 1. Dictionary<string,object>
var users = new[] { new { Name = "Jack", Age = 25 }, new { Name = "Mike", Age = 44 } };
var department = new[] { new { ID = "01", Name = "HR" }, new { ID = "02", Name = "IT" } };
var sheets = new Dictionary<string, object>
{
    ["users"] = users,
    ["department"] = department
};
MiniExcel.SaveAs(path, sheets);</p><p>// 2. DataSet
var sheets = new DataSet();
sheets.Add(UsersDataTable);
sheets.Add(DepartmentDataTable);
//..
MiniExcel.SaveAs(path, sheets);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/118130875-6e7c4580-b430-11eb-9b82-22f02716bd63.png" alt="image"></p><p>
#### 8. Opzioni TableStyles</p><p>Stile predefinito</p><p><img src="https://user-images.githubusercontent.com/12729184/138234373-cfa97109-b71f-4711-b7f5-0eaaa4a0a3a6.png" alt="image"></p><p>Senza configurazione dello stile</p><p></code></pre>csharp
var config = new OpenXmlConfiguration()
{
     TableStyles = TableStyles.None
};
MiniExcel.SaveAs(path, value,configuration:config);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/118784917-f3e57700-b8c2-11eb-8718-8d955b1bc197.png" alt="image"></p><p>
#### 9. AutoFiltro</p><p>Dalla versione v0.19.0 </code>OpenXmlConfiguration.AutoFilter<code> può abilitare/disabilitare l’AutoFiltro, il valore predefinito è </code>true<code>, e il modo per impostare AutoFiltro è:</p><p></code></pre>csharp
MiniExcel.SaveAs(path, value, configuration: new OpenXmlConfiguration() { AutoFilter = false });
<pre><code class="language-">#### 10. Crea Immagine</p><p></code></pre>csharp
var value = new[] {
    new { Name="github",Image=File.ReadAllBytes(PathHelper.GetFile("images/github_logo.png"))},
    new { Name="google",Image=File.ReadAllBytes(PathHelper.GetFile("images/google_logo.png"))},
    new { Name="microsoft",Image=File.ReadAllBytes(PathHelper.GetFile("images/microsoft_logo.png"))},
    new { Name="reddit",Image=File.ReadAllBytes(PathHelper.GetFile("images/reddit_logo.png"))},
    new { Name="statck_overflow",Image=File.ReadAllBytes(PathHelper.GetFile("images/statck_overflow_logo.png"))},
};
MiniExcel.SaveAs(path, value);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/150462383-ad9931b3-ed8d-4221-a1d6-66f799743433.png" alt="image"></p><p>#### 11. Esportazione file array di byte</p><p>Dalla versione 1.22.0, quando il tipo di valore è </code>byte[]<code>, il sistema salverà per impostazione predefinita il percorso del file nella cella, e durante l'importazione il sistema potrà convertirlo in </code>byte[]<code>. Se non vuoi utilizzare questa funzione, puoi impostare </code>OpenXmlConfiguration.EnableConvertByteArray<code> su </code>false<code>, migliorando così l'efficienza del sistema.</p><p><img src="https://user-images.githubusercontent.com/12729184/153702334-c3b834f4-6ae4-4ddf-bd4e-e5005d5d8c6a.png" alt="image"></p><p>Dalla versione 1.22.0, quando il tipo di valore è </code>byte[]<code>, il sistema salverà per impostazione predefinita il percorso del file nella cella, e durante l'importazione il sistema potrà convertirlo in </code>byte[]<code>. Se non vuoi utilizzare questa funzione, puoi impostare </code>OpenXmlConfiguration.EnableConvertByteArray<code> su </code>false<code>, migliorando così l'efficienza del sistema.</p><p><img src="https://user-images.githubusercontent.com/12729184/153702334-c3b834f4-6ae4-4ddf-bd4e-e5005d5d8c6a.png" alt="image"></p><p>#### 12. Unisci le stesse celle verticalmente</p><p>Questa funzionalità è supportata solo nel formato </code>xlsx<code> e unisce le celle verticalmente tra i tag @merge e @endmerge.
Puoi usare @mergelimit per limitare i confini delle celle da unire verticalmente.</p><p></code></pre>csharp
var mergedFilePath = Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid().ToString()}.xlsx");</p><p>var path = @"../../../../../samples/xlsx/TestMergeWithTag.xlsx";</p><p>MiniExcel.MergeSameCells(mergedFilePath, path);
<pre><code class="language-"></p><p></code></pre>csharp
var memoryStream = new MemoryStream();</p><p>var path = @"../../../../../samples/xlsx/TestMergeWithTag.xlsx";</p><p>memoryStream.MergeSameCells(path);
<pre><code class="language-">Contenuto del file prima e dopo l'unione:</p><p>Senza limite di unione:</p><p><img width="318" alt="Screenshot 2023-08-07 at 11 59 24" src="https://github.com/mini-software/MiniExcel/assets/38832863/49cc96b9-6c35-4bf3-8d43-a9752a15b22e"></p><p><img width="318" alt="Screenshot 2023-08-07 at 11 59 57" src="https://github.com/mini-software/MiniExcel/assets/38832863/3fbd529b-3ae6-4bbe-b4d8-2793a5a58010"></p><p>Con limite di unione:</p><p><img width="346" alt="Screenshot 2023-08-08 at 18 21 00" src="https://github.com/mini-software/MiniExcel/assets/38832863/04049d28-84d5-4c2a-bcff-5847547df5e1"></p><p><img width="346" alt="Screenshot 2023-08-08 at 18 21 40" src="https://github.com/mini-software/MiniExcel/assets/38832863/f5cf8957-b0b0-4831-b8fc-8556299235c2"></p><p>#### 13. Salta i valori null</p><p>Nuova opzione esplicita per scrivere celle vuote per i valori null:</p><p></code></pre>csharp
DataTable dt = new DataTable();</p><p>/<em> ... </em>/</p><p>DataRow dr = dt.NewRow();</p><p>dr["Name1"] = "Somebody once";
dr["Name2"] = null;
dr["Name3"] = "told me.";</p><p>dt.Rows.Add(dr);</p><p>OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
     EnableWriteNullValueCell = true // Default value.
};</p><p>MiniExcel.SaveAs(@"C:\temp\Book1.xlsx", dt, configuration: configuration);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/31481586/241419455-3c0aec8a-4e5f-4d83-b7ec-6572124c165d.png" alt="immagine"></p><p></code></pre>xml
<x:row r="2">
    <x:c r="A2" t ="str" s="2">
        <x:v>Somebody once</x:v>
    </x:c>
    <x:c r="B2" s="2"></x:c>
    <x:c r="C2" t ="str" s="2">
        <x:v>told me.</x:v>
    </x:c>
</x:row>
<pre><code class="language-">Comportamento precedente:</p><p></code></pre>csharp
/<em> ... </em>/</p><p>OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
     EnableWriteNullValueCell = false // Default value is true.
};</p><p>MiniExcel.SaveAs(@"C:\temp\Book1.xlsx", dt, configuration: configuration);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/31481586/241419441-c4f27e8f-3f87-46db-a10f-08665864c874.png" alt="immagine"></p><p></code></pre>xml
<x:row r="2">
    <x:c r="A2" t ="str" s="2">
        <x:v>Somebody once</x:v>
    </x:c>
    <x:c r="B2" t ="str" s="2">
        <x:v></x:v>
    </x:c>
    <x:c r="C2" t ="str" s="2">
        <x:v>told me.</x:v>
    </x:c>
</x:row>
<pre><code class="language-">Funziona per valori null e DBNull.</p><p>#### 14. Blocca riquadri
</code></pre>csharp
/<em> ... </em>/</p><p>OpenXmlConfiguration configuration = new OpenXmlConfiguration()
{
    FreezeRowCount = 1,     // default is 1
    FreezeColumnCount = 2   // default is 0
};</p><p>MiniExcel.SaveAs(@"C:\temp\Book1.xlsx", dt, configuration: configuration);
<pre><code class="language-"><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/freeze-pane-1.png" alt="image"></p><h3>Compilare i Dati nel Modello Excel <a name="getstart3"></a></h3></p><ul><li>La dichiarazione è simile al template Vue </code>{{nome variabile}}<code>, oppure al rendering di una collezione </code>{{nome collezione.nome campo}}<code></li>
<li>Il rendering delle collezioni supporta IEnumerable/DataTable/DapperRow</li></p><p></ul>#### 1. Compilazione Base</p><p>Modello:
<img src="https://user-images.githubusercontent.com/12729184/114537556-ed8d2b00-9c84-11eb-8303-a69f62c41e5b.png" alt="image"></p><p>Risultato:
<img src="https://user-images.githubusercontent.com/12729184/114537490-d8180100-9c84-11eb-8c69-db58692f3a85.png" alt="image"></p><p>Codice:
</code></pre>csharp
// 1. By POCO
var value = new
{
    Name = "Jack",
    CreateDate = new DateTime(2021, 01, 01),
    VIP = true,
    Points = 123
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);</p><p>
// 2. By Dictionary
var value = new Dictionary<string, object>()
{
    ["Name"] = "Jack",
    ["CreateDate"] = new DateTime(2021, 01, 01),
    ["VIP"] = true,
    ["Points"] = 123
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
<pre><code class="language-">#### 2. Riempimento Dati IEnumerable</p><blockquote>Nota1: Utilizzare il primo IEnumerable della stessa colonna come base per riempire la lista</blockquote></p><p>Template:
<img src="https://user-images.githubusercontent.com/12729184/114564652-14f2f080-9ca3-11eb-831f-09e3fedbc5fc.png" alt="image"></p><p>Risultato:
<img src="https://user-images.githubusercontent.com/12729184/114564204-b2015980-9ca2-11eb-900d-e21249f93f7c.png" alt="image"></p><p>Codice:</p><p>
</code></pre>csharp
//1. By POCO
var value = new
{
    employees = new[] {
        new {name="Jack",department="HR"},
        new {name="Lisa",department="HR"},
        new {name="John",department="HR"},
        new {name="Mike",department="IT"},
        new {name="Neo",department="IT"},
        new {name="Loan",department="IT"}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);</p><p>//2. By Dictionary
var value = new Dictionary<string, object>()
{
    ["employees"] = new[] {
        new {name="Jack",department="HR"},
        new {name="Lisa",department="HR"},
        new {name="John",department="HR"},
        new {name="Mike",department="IT"},
        new {name="Neo",department="IT"},
        new {name="Loan",department="IT"}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
<pre><code class="language-">
#### 3. Compilazione Dati Complessi</p><blockquote>Nota: Supporta multi-fogli e utilizzo della stessa variabile</blockquote></p><p>Template:</p><p><img src="https://user-images.githubusercontent.com/12729184/114565255-acf0da00-9ca3-11eb-8a7f-8131b2265ae8.png" alt="image"></p><p>Risultato:</p><p><img src="https://user-images.githubusercontent.com/12729184/114565329-bf6b1380-9ca3-11eb-85e3-3969e8bf6378.png" alt="image">
</code></pre>csharp
// 1. By POCO
var value = new
{
    title = "FooCompany",
    managers = new[] {
        new {name="Jack",department="HR"},
        new {name="Loan",department="IT"}
    },
    employees = new[] {
        new {name="Wade",department="HR"},
        new {name="Felix",department="HR"},
        new {name="Eric",department="IT"},
        new {name="Keaton",department="IT"}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);</p><p>// 2. By Dictionary
var value = new Dictionary<string, object>()
{
    ["title"] = "FooCompany",
    ["managers"] = new[] {
        new {name="Jack",department="HR"},
        new {name="Loan",department="IT"}
    },
    ["employees"] = new[] {
        new {name="Wade",department="HR"},
        new {name="Felix",department="HR"},
        new {name="Eric",department="IT"},
        new {name="Keaton",department="IT"}
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
<pre><code class="language-">#### 4. Prestazioni di riempimento Big Data</p><blockquote>NOTA: Usare l'esecuzione differita IEnumerable invece di ToList può ridurre al massimo l'uso della memoria in MiniExcel</blockquote></p><p><img src="https://user-images.githubusercontent.com/12729184/114577091-5046ec80-9cae-11eb-924b-087c7becf8da.png" alt="image"></p><p>#### 5. Tipo di mappatura automatica del valore della cella</p><p>Template</p><p><img src="https://user-images.githubusercontent.com/12729184/114802504-64830a80-9dd0-11eb-8d56-8e8c401b3ace.png" alt="image"></p><p>Risultato</p><p><img src="https://user-images.githubusercontent.com/12729184/114802419-43221e80-9dd0-11eb-9ffe-a2ce34fe7076.png" alt="image"></p><p>Classe</p><p></code></pre>csharp
public class Poco
{
    public string @string { get; set; }
    public int? @int { get; set; }
    public decimal? @decimal { get; set; }
    public double? @double { get; set; }
    public DateTime? datetime { get; set; }
    public bool? @bool { get; set; }
    public Guid? Guid { get; set; }
}
<pre><code class="language-">Codice</p><p></code></pre>csharp
var poco = new TestIEnumerableTypePoco { @string = "string", @int = 123, @decimal = decimal.Parse("123.45"), @double = (double)123.33, @datetime = new DateTime(2021, 4, 1), @bool = true, @Guid = Guid.NewGuid() };
var value = new
{
    Ts = new[] {
        poco,
        new TestIEnumerableTypePoco{},
        null,
        poco
    }
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
<pre><code class="language-">#### 6. Esempio :  Elencare Progetti Github</p><p>Modello</p><p><img src="https://user-images.githubusercontent.com/12729184/115068623-12073280-9f25-11eb-9124-f4b3efcdb2a7.png" alt="image"></p><p>
Risultato</p><p><img src="https://user-images.githubusercontent.com/12729184/115068639-1a5f6d80-9f25-11eb-9f45-27c434d19a78.png" alt="image"></p><p>Codice</p><p></code></pre>csharp
var projects = new[]
{
    new {Name = "MiniExcel",Link="https://github.com/mini-software/MiniExcel",Star=146, CreateTime=new DateTime(2021,03,01)},
    new {Name = "HtmlTableHelper",Link="https://github.com/mini-software/HtmlTableHelper",Star=16, CreateTime=new DateTime(2020,02,01)},
    new {Name = "PocoClassGenerator",Link="https://github.com/mini-software/PocoClassGenerator",Star=16, CreateTime=new DateTime(2019,03,17)}
};
var value = new
{
    User = "ITWeiHan",
    Projects = projects,
    TotalStar = projects.Sum(s => s.Star)
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
<pre><code class="language-">#### 7. Riempimento Dati Raggruppati</p><p></code></pre>csharp
var value = new Dictionary<string, object>()
{
    ["employees"] = new[] {
        new {name="Jack",department="HR"},
        new {name="Jack",department="HR"},
        new {name="John",department="HR"},
        new {name="John",department="IT"},
        new {name="Neo",department="IT"},
        new {name="Loan",department="IT"}
    }
};
await MiniExcel.SaveAsByTemplateAsync(path, templatePath, value);
<pre><code class="language-">##### 1. Con tag </code>@group<code> e con tag </code>@header<code></p><p>Prima</p><p><img src="https://user-images.githubusercontent.com/38832863/218646717-21b9d57a-2be2-4e9a-801b-ae212231d2b4.PNG" alt="before_with_header"></p><p>Dopo</p><p><img src="https://user-images.githubusercontent.com/38832863/218646721-58a7a340-7004-4bc2-af24-cffcb2c20737.PNG" alt="after_with_header"></p><p>##### 2. Con tag @group e senza tag @header</p><p>Prima</p><p><img src="https://user-images.githubusercontent.com/38832863/218646873-b12417fa-801b-4890-8e96-669ed3b43902.PNG" alt="before_without_header"></p><p>Dopo</p><p><img src="https://user-images.githubusercontent.com/38832863/218646872-622461ba-342e-49ee-834f-b91ad9c2dac3.PNG" alt="after_without_header"></p><p>##### 3. Senza tag @group</p><p>Prima</p><p><img src="https://user-images.githubusercontent.com/38832863/218646975-f52a68eb-e031-43b5-abaa-03b67c052d1a.PNG" alt="without_group"></p><p>Dopo</p><p><img src="https://user-images.githubusercontent.com/38832863/218646974-4a3c0e07-7c66-4088-ad07-b4ad3695b7e1.PNG" alt="without_group_after"></p><p>#### 8. Istruzioni If/ElseIf/Else all'interno della cella</p><p>Regole:
<ul><li>Supporta DateTime, Double, Int con operatori ==, !=, >, >=, <, <=.</li>
<li>Supporta String con operatori ==, !=.</li>
<li>Ogni istruzione deve essere su una nuova riga.</li>
<li>Va aggiunto uno spazio singolo prima e dopo gli operatori.</li>
<li>Non ci devono essere nuove righe all'interno delle istruzioni.</li>
<li>La cella deve avere esattamente il formato seguente.</li>
</ul></code></pre>csharp
@if(name == Jack)
{{employees.name}}
@elseif(name == Neo)
Test {{employees.name}}
@else
{{employees.department}}
@endif
<pre><code class="language-">Prima</p><p><img src="https://user-images.githubusercontent.com/38832863/235360606-ca654769-ff55-4f5b-98d2-d2ec0edb8173.PNG" alt="if_before"></p><p>Dopo</p><p><img src="https://user-images.githubusercontent.com/38832863/235360609-869bb960-d63d-45ae-8d64-9e8b0d0ab658.PNG" alt="if_after"></p><p>#### 9. DataTable come parametro</p><p></code></pre>csharp
var managers = new DataTable();
{
    managers.Columns.Add("name");
    managers.Columns.Add("department");
    managers.Rows.Add("Jack", "HR");
    managers.Rows.Add("Loan", "IT");
}
var value = new Dictionary<string, object>()
{
    ["title"] = "FooCompany",
    ["managers"] = managers,
};
MiniExcel.SaveAsByTemplate(path, templatePath, value);
<pre><code class="language-">#### 10. Formule</p><p>##### 1. Esempio
Anteponi il prefisso </code>$<code> alla tua formula e usa </code>$enumrowstart<code> e </code>$enumrowend<code> per contrassegnare i riferimenti alle righe iniziali e finali enumerabili:</p><p><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/template-formulas-1.png" alt="image"></p><p>Quando il template viene renderizzato, il prefisso </code>$<code> verrà rimosso e </code>$enumrowstart<code> e </code>$enumrowend<code> verranno sostituiti con i numeri di riga iniziali e finali dell'enumerabile:</p><p><img src="https://raw.githubusercontent.com/mini-software/MiniExcel/master/docs/images/template-formulas-2.png" alt="image"></p><p>##### 2. Altri esempi di formule:</p><p>|              |                                                                                           |
|--------------|-------------------------------------------------------------------------------------------|
| Somma        | </code>$=SUM(C{{$enumrowstart}}:C{{$enumrowend}})<code>                                              |
| Media alt.   | </code>$=SUM(C{{$enumrowstart}}:C{{$enumrowend}}) / COUNT(C{{$enumrowstart}}:C{{$enumrowend}})<code> |
| Intervallo   | </code>$=MAX(C{{$enumrowstart}}:C{{$enumrowend}}) - MIN(C{{$enumrowstart}}:C{{$enumrowend}})<code>   |</p><p>
#### 11. Altro</p><p>##### 1. Verifica della chiave del parametro del template</p><p>Dalla versione V1.24.0, per impostazione predefinita viene ignorata la chiave del parametro mancante nel template e sostituita con una stringa vuota, </code>IgnoreTemplateParameterMissing<code> può controllare se lanciare un'eccezione o meno.
</code></pre>csharp
var config = new OpenXmlConfiguration()
{
    IgnoreTemplateParameterMissing = false,
};
MiniExcel.SaveAsByTemplate(path, templatePath, value, config)
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/157464332-e316f829-54aa-4c84-a5aa-9aef337b668d.png" alt="image"></p><h3>Attributo Nome/Indice/Ignora Colonna di Excel <a name="getstart4"></a></h3></p><p>#### 1. Specificare il nome della colonna, l'indice della colonna, ignorare la colonna</p><p>Esempio Excel</p><p><img src="https://user-images.githubusercontent.com/12729184/114230869-3e163700-99ac-11eb-9a90-2039d4b4b313.png" alt="image"></p><p>Codice</p><p></code></pre>csharp
public class ExcelAttributeDemo
{
    [ExcelColumnName("Column1")]
    public string Test1 { get; set; }
    [ExcelColumnName("Column2")]
    public string Test2 { get; set; }
    [ExcelIgnore]
    public string Test3 { get; set; }
    [ExcelColumnIndex("I")] // system will convert "I" to 8 index
    public string Test4 { get; set; }
    public string Test5 { get; } //wihout set will ignore
    public string Test6 { get; private set; } //un-public set will ignore
    [ExcelColumnIndex(3)] // start with 0
    public string Test7 { get; set; }
}</p><p>var rows = MiniExcel.Query<ExcelAttributeDemo>(path).ToList();
Assert.Equal("Column1", rows[0].Test1);
Assert.Equal("Column2", rows[0].Test2);
Assert.Null(rows[0].Test3);
Assert.Equal("Test7", rows[0].Test4);
Assert.Null(rows[0].Test5);
Assert.Null(rows[0].Test6);
Assert.Equal("Test4", rows[0].Test7);
<pre><code class="language-"></p><p>#### 2. Formato Personalizzato (ExcelFormatAttribute)</p><p>Dalla versione V0.21.0 è supportata la classe che contiene il metodo di formato </code>ToString(string content)<code></p><p>Classe</p><p></code></pre>csharp
public class Dto
{
    public string Name { get; set; }</p><p>    [ExcelFormat("MMMM dd, yyyy")]
    public DateTime InDate { get; set; }
}
<pre><code class="language-">Codice</p><p></code></pre>csharp
var value = new Dto[] {
    new Issue241Dto{ Name="Jack",InDate=new DateTime(2021,01,04)},
    new Issue241Dto{ Name="Henry",InDate=new DateTime(2020,04,05)},
};
MiniExcel.SaveAs(path, value);
<pre><code class="language-">Risultato</p><p><img src="https://user-images.githubusercontent.com/12729184/118910788-ab2bcd80-b957-11eb-8d42-bfce36621b1b.png" alt="image"></p><p>La query supporta la conversione personalizzata del formato</p><p><img src="https://user-images.githubusercontent.com/12729184/118911286-87b55280-b958-11eb-9a88-c8ff403d240a.png" alt="image"></p><p>#### 3. Imposta larghezza colonna (ExcelColumnWidthAttribute)</p><p></code></pre>csharp
public class Dto
{
    [ExcelColumnWidth(20)]
    public int ID { get; set; }
    [ExcelColumnWidth(15.50)]
    public string Name { get; set; }
}
<pre><code class="language-">#### 4. Più nomi di colonne mappati sulla stessa proprietà.</p><p></code></pre>csharp
public class Dto
{
    [ExcelColumnName(excelColumnName:"EmployeeNo",aliases:new[] { "EmpNo","No" })]
    public string Empno { get; set; }
    public string Name { get; set; }
}
<pre><code class="language-"></p><p>#### 5. System.ComponentModel.DisplayNameAttribute = ExcelColumnName.excelColumnNameAttribute</p><p>Dalla versione 1.24.0, il sistema supporta System.ComponentModel.DisplayNameAttribute = ExcelColumnName.excelColumnNameAttribute
</code></pre>C#
public class TestIssueI4TXGTDto
{
    public int ID { get; set; }
    public string Name { get; set; }
    [DisplayName("Specification")]
    public string Spc { get; set; }
    [DisplayName("Unit Price")]
    public decimal Up { get; set; }
}
<pre><code class="language-">#### 6. ExcelColumnAttribute</p><p>Dalla versione V1.26.0, più attributi possono essere semplificati come segue:</p><p>
</code></pre>csharp
        public class TestIssueI4ZYUUDto
        {
            [ExcelColumn(Name = "ID",Index =0)]
            public string MyProperty { get; set; }
            [ExcelColumn(Name = "CreateDate", Index = 1,Format ="yyyy-MM",Width =100)]
            public DateTime MyProperty2 { get; set; }
        }
<pre><code class="language-">#### 7. DynamicColumnAttribute</p><p>Dalla versione V1.26.0, possiamo impostare dinamicamente gli attributi di Column</p><p>
</code></pre>csharp
            var config = new OpenXmlConfiguration
            {
                DynamicColumns = new DynamicExcelColumn[] {
                    new DynamicExcelColumn("id"){Ignore=true},
                    new DynamicExcelColumn("name"){Index=1,Width=10},
                    new DynamicExcelColumn("createdate"){Index=0,Format="yyyy-MM-dd",Width=15},
                    new DynamicExcelColumn("point"){Index=2,Name="Account Point"},
                }
            };
            var path = PathHelper.GetTempPath();
            var value = new[] { new { id = 1, name = "Jack", createdate = new DateTime(2022, 04, 12) ,point = 123.456} };
            MiniExcel.SaveAs(path, value, configuration: config);
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/164510353-5aecbc4e-c3ce-41e8-b6cf-afd55eb23b68.png" alt="image"></p><p>#### 8. DynamicSheetAttribute</p><p>Dalla versione V1.31.4 è possibile impostare dinamicamente gli attributi del foglio. Possiamo impostare il nome del foglio e lo stato (visibilità).</code></pre>csharp
            var configuration = new OpenXmlConfiguration
            {
                DynamicSheets = new DynamicExcelSheet[] {
                    new DynamicExcelSheet("usersSheet") { Name = "Users", State = SheetState.Visible },
                    new DynamicExcelSheet("departmentSheet") { Name = "Departments", State = SheetState.Hidden }
                }
            };</p><p>            var users = new[] { new { Name = "Jack", Age = 25 }, new { Name = "Mike", Age = 44 } };
            var department = new[] { new { ID = "01", Name = "HR" }, new { ID = "02", Name = "IT" } };
            var sheets = new Dictionary<string, object>
            {
                ["usersSheet"] = users,
                ["departmentSheet"] = department
            };</p><p>            var path = PathHelper.GetTempPath();
            MiniExcel.SaveAs(path, sheets, configuration: configuration);
<pre><code class="language-">Possiamo anche utilizzare il nuovo attributo ExcelSheetAttribute:</p><p></code></pre>C#
   [ExcelSheet(Name = "Departments", State = SheetState.Hidden)]
   private class DepartmentDto
   {
      [ExcelColumn(Name = "ID",Index = 0)]
      public string ID { get; set; }
      [ExcelColumn(Name = "Name",Index = 1)]
      public string Name { get; set; }
   }
<pre><code class="language-">### Aggiungi, Elimina, Aggiorna</p><p>#### Aggiungi</p><p>v1.28.0 supporta l'inserimento di N righe di dati CSV dopo l'ultima riga</p><p></code></pre>csharp
// Origin
{
    var value = new[] {
          new { ID=1,Name ="Jack",InDate=new DateTime(2021,01,03)},
          new { ID=2,Name ="Henry",InDate=new DateTime(2020,05,03)},
    };
    MiniExcel.SaveAs(path, value);
}
// Insert 1 rows after last
{
    var value = new { ID=3,Name = "Mike", InDate = new DateTime(2021, 04, 23) };
    MiniExcel.Insert(path, value);
}
// Insert N rows after last
{
    var value = new[] {
          new { ID=4,Name ="Frank",InDate=new DateTime(2021,06,07)},
          new { ID=5,Name ="Gloria",InDate=new DateTime(2022,05,03)},
    };
    MiniExcel.Insert(path, value);
}
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/191023733-1e2fa732-db5c-4a3a-9722-b891fe5aa069.png" alt="image"></p><p>v1.37.0 supporta l'inserimento di un nuovo foglio Excel in una cartella di lavoro esistente</p><p></code></pre>csharp
// Origin excel
{
    var value = new[] {
          new { ID=1,Name ="Jack",InDate=new DateTime(2021,01,03)},
          new { ID=2,Name ="Henry",InDate=new DateTime(2020,05,03)},
    };
    MiniExcel.SaveAs(path, value, sheetName: "Sheet1");
}
// Insert a new sheet
{
    var value = new { ID=3,Name = "Mike", InDate = new DateTime(2021, 04, 23) };
    MiniExcel.Insert(path, table, sheetName: "Sheet2");
}
<pre><code class="language-">#### Elimina(in attesa)</p><p>#### Aggiorna(in attesa)</p><h3>Controllo automatico del tipo di Excel <a name="getstart5"></a></h3></p><ul><li>MiniExcel controllerà se è xlsx o csv in base all'</code>estensione del file<code> per impostazione predefinita, ma potrebbero esserci imprecisioni, si prega di specificarlo manualmente.</li>
<li>Non è possibile sapere da quale Excel provenga uno stream, si prega di specificarlo manualmente.</li></p><p></ul></code></pre>csharp
stream.SaveAs(excelType:ExcelType.CSV);
//or
stream.SaveAs(excelType:ExcelType.XLSX);
//or
stream.Query(excelType:ExcelType.CSV);
//or
stream.Query(excelType:ExcelType.XLSX);
<pre><code class="language-"></p><h3>CSV</h3></p><p>#### Nota</p><ul><li>Per impostazione predefinita restituisce il tipo </code>string<code>, e il valore non verrà convertito in numeri o datetime, a meno che il tipo non sia definito tramite strong typing generico.</li></p><p></ul>#### Separatore personalizzato</p><p>Il valore predefinito è </code>,<code> come separatore, puoi modificare la proprietà </code>Seperator<code> per la personalizzazione</p><p></code></pre>csharp
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    Seperator=';'
};
MiniExcel.SaveAs(path, values,configuration: config);
<pre><code class="language-">Dalla versione V1.30.1 supporta la funzione per personalizzare il separatore (grazie a @hyzx86)</p><p></code></pre>csharp
var config = new CsvConfiguration()
{
    SplitFn = (row) => Regex.Split(row, $"<a href="?=(?:[^\"]|\"[^\"]<em>\"" target="_blank" rel="noopener noreferrer">\t,</a></em>$)")
        .Select(s => Regex.Replace(s.Replace("\"\"", "\""), "^\"|\"$", "")).ToArray()
};
var rows = MiniExcel.Query(path, configuration: config).ToList();
<pre><code class="language-">#### Interruzione di riga personalizzata</p><p>Il valore predefinito è </code>\r\n<code> come carattere di nuova riga, puoi modificare la proprietà </code>NewLine<code> per la personalizzazione</p><p></code></pre>csharp
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    NewLine='\n'
};
MiniExcel.SaveAs(path, values,configuration: config);
<pre><code class="language-">#### Codifica personalizzata</p><ul><li>La codifica predefinita è "Rileva codifica dai contrassegni di ordine dei byte" (detectEncodingFromByteOrderMarks: true)</li>
<li>Se hai esigenze di codifica personalizzate, modifica la proprietà StreamReaderFunc / StreamWriterFunc</li></p><p></ul></code></pre>csharp
// Read
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    StreamReaderFunc = (stream) => new StreamReader(stream,Encoding.GetEncoding("gb2312"))
};
var rows = MiniExcel.Query(path, true,excelType:ExcelType.CSV,configuration: config);</p><p>// Write
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
    StreamWriterFunc = (stream) => new StreamWriter(stream, Encoding.GetEncoding("gb2312"))
};
MiniExcel.SaveAs(path, value,excelType:ExcelType.CSV, configuration: config);
<pre><code class="language-">#### Leggi stringa vuota come null</p><p>Per impostazione predefinita, i valori vuoti vengono mappati su string.Empty. Puoi modificare questo comportamento</p><p></code></pre>csharp
var config = new MiniExcelLibs.Csv.CsvConfiguration()
{
   ReadEmptyStringAsNull = true
};
<pre><code class="language-">### DataReader</p><p>#### 1. GetReader
Dalla versione 1.23.0, puoi usare GetDataReader</p><p>
</code></pre>csharp
    using (var reader = MiniExcel.GetReader(path,true))
    {
        while (reader.Read())
        {
            for (int i = 0; i < reader.FieldCount; i++)
            {
                var value = reader.GetValue(i);
            }
        }
    }
<pre><code class="language-"></p><h3> Async</h3></p><ul><li>v0.17.0 supporta Async (grazie a isdaniel ( SHIH,BING-SIOU)](https://github.com/isdaniel))</li></p><p></ul></code></pre>csharp
public static Task SaveAsAsync(string path, object value, bool printHeader = true, string sheetName = "Sheet1", ExcelType excelType = ExcelType.UNKNOWN, IConfiguration configuration = null)
public static Task SaveAsAsync(this Stream stream, object value, bool printHeader = true, string sheetName = "Sheet1", ExcelType excelType = ExcelType.XLSX, IConfiguration configuration = null)
public static Task<IEnumerable<dynamic>> QueryAsync(string path, bool useHeaderRow = false, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = "A1", IConfiguration configuration = null)
public static Task<IEnumerable<T>> QueryAsync<T>(this Stream stream, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = "A1", IConfiguration configuration = null) where T : class, new()
public static Task<IEnumerable<T>> QueryAsync<T>(string path, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = "A1", IConfiguration configuration = null) where T : class, new()
public static Task<IEnumerable<IDictionary<string, object>>> QueryAsync(this Stream stream, bool useHeaderRow = false, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = "A1", IConfiguration configuration = null)
public static Task SaveAsByTemplateAsync(this Stream stream, string templatePath, object value)
public static Task SaveAsByTemplateAsync(this Stream stream, byte[] templateBytes, object value)
public static Task SaveAsByTemplateAsync(string path, string templatePath, object value)
public static Task SaveAsByTemplateAsync(string path, byte[] templateBytes, object value)
public static Task<DataTable> QueryAsDataTableAsync(string path, bool useHeaderRow = true, string sheetName = null, ExcelType excelType = ExcelType.UNKNOWN, string startCell = "A1", IConfiguration configuration = null)
<pre><code class="language-">- v1.25.0 supporta </code>cancellationToken<code>。</p><h3>Altri</h3></p><p>#### 1. Enum</p><p>Assicurarsi che il nome in excel e nella proprietà sia lo stesso, il sistema eseguirà il mapping automatico (non fa distinzione tra maiuscole e minuscole)</p><p><img src="https://user-images.githubusercontent.com/12729184/116210595-9784b100-a775-11eb-936f-8e7a8b435961.png" alt="image"></p><p>Dalla versione V0.18.0 è supportata la descrizione degli Enum</p><p></code></pre>csharp
public class Dto
{
    public string Name { get; set; }
    public I49RYZUserType UserType { get; set; }
}</p><p>public enum Type
{
    [Description("General User")]
    V1,
    [Description("General Administrator")]
    V2,
    [Description("Super Administrator")]
    V3
}
<pre><code class="language-"><img src="https://user-images.githubusercontent.com/12729184/133116630-27cc7161-099a-48b8-9784-cd1e443af3d1.png" alt="image"></p><p>Dalla versione 1.30.0 è supportata la descrizione Excel per Enum, grazie a @KaneLeung</p><p>#### 2. Convertire CSV in XLSX o Convertire XLSX in CSV</p><p></code></pre>csharp
MiniExcel.ConvertXlsxToCsv(xlsxPath, csvPath);
MiniExcel.ConvertXlsxToCsv(xlsxStream, csvStream);
MiniExcel.ConvertCsvToXlsx(csvPath, xlsxPath);
MiniExcel.ConvertCsvToXlsx(csvStream, xlsxStream);
<pre><code class="language-"></code>`<code>csharp
using (var excelStream = new FileStream(path: filePath, FileMode.Open, FileAccess.Read))
using (var csvStream = new MemoryStream())
{
   MiniExcel.ConvertXlsxToCsv(excelStream, csvStream);
}</code></pre>
#### 3. CultureInfo personalizzato</p><p>Dalla versione 1.22.0, puoi personalizzare CultureInfo come segue, il valore predefinito di sistema è </code>CultureInfo.InvariantCulture<code>.</p><pre><code class="language-csharp">var config = new CsvConfiguration()
{
    Culture = new CultureInfo("fr-FR"),
};
MiniExcel.SaveAs(path, value, configuration: config);</p><p>// or
MiniExcel.Query(path, configuration: config);</code></pre>
#### 4. Dimensione Buffer Personalizzata</p><pre><code class="language-csharp">    public abstract class Configuration : IConfiguration
    {
        public int BufferSize { get; set; } = 1024 * 512;
    }</code></pre>
#### 5. Modalità Veloce</p><p>Il sistema non controllerà la memoria, ma puoi ottenere una velocità di salvataggio più elevata.</p><pre><code class="language-csharp">var config = new OpenXmlConfiguration() { FastMode = true };
MiniExcel.SaveAs(path, reader,configuration:config);</code></pre>
#### 6. Aggiunta Immagine in Batch (MiniExcel.AddPicture)</p><p>Si prega di aggiungere le immagini prima di generare in batch i dati delle righe, altrimenti il sistema utilizzerà molta memoria quando si chiama AddPicture.</p><pre><code class="language-csharp">var images = new[]
{
    new MiniExcelPicture
    {
        ImageBytes = File.ReadAllBytes(PathHelper.GetFile("images/github_logo.png")),
        SheetName = null, // default null is first sheet
        CellAddress = "C3", // required
    },
    new MiniExcelPicture
    {
        ImageBytes = File.ReadAllBytes(PathHelper.GetFile("images/google_logo.png")),
        PictureType = "image/png", // default PictureType = image/png
        SheetName = "Demo",
        CellAddress = "C9", // required
        WidthPx = 100,
        HeightPx = 100,
    },
};
MiniExcel.AddPicture(path, images);</code></pre>
<img src="https://github.com/user-attachments/assets/19c4d241-9753-4ede-96c8-f810c1a22247" alt="Immagine"></p><p>#### 7. Ottieni le dimensioni dei fogli</p><pre><code class="language-csharp">var dim = MiniExcel.GetSheetDimensions(path);</code></pre>
<h3>Esempi:</h3></p><p>#### 1. Inserimento SQL di </code>File di Grandi Dimensioni<code> con SQLite & Dapper per Evitare OOM</p><p>nota: per favore non chiamare i metodi ToList/ToArray dopo Query, caricheranno tutti i dati in memoria</p><pre><code class="language-csharp">using (var connection = new SQLiteConnection(connectionString))
{
    connection.Open();
    using (var transaction = connection.BeginTransaction())
    using (var stream = File.OpenRead(path))
    {
       var rows = stream.Query();
       foreach (var row in rows)
             connection.Execute("insert into T (A,B) values (@A,@B)", new { row.A, row.B }, transaction: transaction);
       transaction.Commit();
    }
}</code></pre>
prestazioni:
<img src="https://user-images.githubusercontent.com/12729184/111072579-2dda7b80-8516-11eb-9843-c01a1edc88ec.png" alt="image"></p><p>#### 2. ASP.NET Core 3.1 o MVC 5 Download/Upload API Excel Xlsx Demo <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/tests/MiniExcel.Tests.AspNetCore" target="_blank" rel="noopener noreferrer">Provalo</a></p><pre><code class="language-csharp">public class ApiController : Controller
{
    public IActionResult Index()
    {
        return new ContentResult
        {
            ContentType = "text/html",
            StatusCode = (int)HttpStatusCode.OK,
            Content = @"<html><body>
<a href='api/DownloadExcel'>DownloadExcel</a><br>
<a href='api/DownloadExcelFromTemplatePath'>DownloadExcelFromTemplatePath</a><br>
<a href='api/DownloadExcelFromTemplateBytes'>DownloadExcelFromTemplateBytes</a><br>
<p>Upload Excel</p>
<form method='post' enctype='multipart/form-data' action='/api/uploadexcel'>
    <input type='file' name='excel'> <br>
    <input type='submit' >
</form>
</body></html{{"
        };
    }</p><p>    public IActionResult DownloadExcel()
    {
        var values = new[] {
            new { Column1 = "MiniExcel", Column2 = 1 },
            new { Column1 = "Github", Column2 = 2}
        };
        var memoryStream = new MemoryStream();
        memoryStream.SaveAs(values);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
        {
            FileDownloadName = "demo.xlsx"
        };
    }</p><p>    public IActionResult DownloadExcelFromTemplatePath()
    {
        string templatePath = "TestTemplateComplex.xlsx";</p><p>        Dictionary<string, object> value = new Dictionary<string, object>()
        {
            ["title"] = "FooCompany",
            ["managers"] = new[] {
                new {name="Jack",department="HR"},
                new {name="Loan",department="IT"}
            },
            ["employees"] = new[] {
                new {name="Wade",department="HR"},
                new {name="Felix",department="HR"},
                new {name="Eric",department="IT"},
                new {name="Keaton",department="IT"}
            }
        };</p><p>        MemoryStream memoryStream = new MemoryStream();
        memoryStream.SaveAsByTemplate(templatePath, value);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
        {
            FileDownloadName = "demo.xlsx"
        };
    }</p><p>    private static Dictionary<string, Byte[]> TemplateBytesCache = new Dictionary<string, byte[]>();</p><p>    static ApiController()
    {
        string templatePath = "TestTemplateComplex.xlsx";
        byte[] bytes = System.IO.File.ReadAllBytes(templatePath);
        TemplateBytesCache.Add(templatePath, bytes);
    }</p><p>    public IActionResult DownloadExcelFromTemplateBytes()
    {
        byte[] bytes = TemplateBytesCache["TestTemplateComplex.xlsx"];</p><p>        Dictionary<string, object> value = new Dictionary<string, object>()
        {
            ["title"] = "FooCompany",
            ["managers"] = new[] {
                new {name="Jack",department="HR"},
                new {name="Loan",department="IT"}
            },
            ["employees"] = new[] {
                new {name="Wade",department="HR"},
                new {name="Felix",department="HR"},
                new {name="Eric",department="IT"},
                new {name="Keaton",department="IT"}
            }
        };</p><p>        MemoryStream memoryStream = new MemoryStream();
        memoryStream.SaveAsByTemplate(bytes, value);
        memoryStream.Seek(0, SeekOrigin.Begin);
        return new FileStreamResult(memoryStream, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
        {
            FileDownloadName = "demo.xlsx"
        };
    }</p><p>    public IActionResult UploadExcel(IFormFile excel)
    {
        var stream = new MemoryStream();
        excel.CopyTo(stream);</p><p>        foreach (var item in stream.Query(true))
        {
            // do your logic etc.
        }</p><p>        return Ok("File uploaded successfully");
    }
}</code></pre>
####  3. Query di Paginazione</p><pre><code class="language-csharp">void Main()
{
    var rows = MiniExcel.Query(path);</p><p>    Console.WriteLine("==== No.1 Page ====");
    Console.WriteLine(Page(rows,pageSize:3,page:1));
    Console.WriteLine("==== No.50 Page ====");
    Console.WriteLine(Page(rows,pageSize:3,page:50));
    Console.WriteLine("==== No.5000 Page ====");
    Console.WriteLine(Page(rows,pageSize:3,page:5000));
}</p><p>public static IEnumerable<T> Page<T>(IEnumerable<T> en, int pageSize, int page)
{
    return en.Skip(page * pageSize).Take(pageSize);
}</code></pre>
<img src="https://user-images.githubusercontent.com/12729184/114679083-6ef4c400-9d3e-11eb-9f78-a86daa45fe46.gif" alt="20210419"></p><p>#### 4. WebForm esporta Excel tramite memorystream</p><pre><code class="language-csharp">var fileName = "Demo.xlsx";
var sheetName = "Sheet1";
HttpResponse response = HttpContext.Current.Response;
response.Clear();
response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
response.AddHeader("Content-Disposition", $"attachment;filename=\"{fileName}\"");
var values = new[] {
    new { Column1 = "MiniExcel", Column2 = 1 },
    new { Column1 = "Github", Column2 = 2}
};
var memoryStream = new MemoryStream();
memoryStream.SaveAs(values, sheetName: sheetName);
memoryStream.Seek(0, SeekOrigin.Begin);
memoryStream.CopyTo(Response.OutputStream);
response.End();</code></pre>
#### 5. Gestione dinamica di i18n multilingue e autorità dei ruoli</p><p>Come nell'esempio, crea un metodo per gestire i18n e la gestione dei permessi, e usa </code>yield return per restituire IEnumerable<Dictionary<string, object>><code> per ottenere effetti dinamici e di basso consumo di memoria</p><pre><code class="language-csharp">void Main()
{
    var value = new Order[] {
        new Order(){OrderNo = "SO01",CustomerID="C001",ProductID="P001",Qty=100,Amt=500},
        new Order(){OrderNo = "SO02",CustomerID="C002",ProductID="P002",Qty=300,Amt=400},
    };</p><p>    Console.WriteLine("en-Us and Sales role");
    {
        var path = Path.GetTempPath() + Guid.NewGuid() + ".xlsx";
        var lang = "en-US";
        var role = "Sales";
        MiniExcel.SaveAs(path, GetOrders(lang, role, value));
        MiniExcel.Query(path, true).Dump();
    }</p><p>    Console.WriteLine("zh-CN and PMC role");
    {
        var path = Path.GetTempPath() + Guid.NewGuid() + ".xlsx";
        var lang = "zh-CN";
        var role = "PMC";
        MiniExcel.SaveAs(path, GetOrders(lang, role, value));
        MiniExcel.Query(path, true).Dump();
    }
}</p><p>private IEnumerable<Dictionary<string, object>> GetOrders(string lang, string role, Order[] orders)
{
    foreach (var order in orders)
    {
        var newOrder = new Dictionary<string, object>();</p><p>        if (lang == "zh-CN")
        {
            newOrder.Add("客户编号", order.CustomerID);
            newOrder.Add("订单编号", order.OrderNo);
            newOrder.Add("产品编号", order.ProductID);
            newOrder.Add("数量", order.Qty);
            if (role == "Sales")
                newOrder.Add("价格", order.Amt);
            yield return newOrder;
        }
        else if (lang == "en-US")
        {
            newOrder.Add("Customer ID", order.CustomerID);
            newOrder.Add("Order No", order.OrderNo);
            newOrder.Add("Product ID", order.ProductID);
            newOrder.Add("Quantity", order.Qty);
            if (role == "Sales")
                newOrder.Add("Amount", order.Amt);
            yield return newOrder;
        }
        else
        {
            throw new InvalidDataException($"lang {lang} wrong");
        }
    }
}</p><p>public class Order
{
    public string OrderNo { get; set; }
    public string CustomerID { get; set; }
    public decimal Qty { get; set; }
    public string ProductID { get; set; }
    public decimal Amt { get; set; }
}</code></pre>
<img src="https://user-images.githubusercontent.com/12729184/118939964-d24bc480-b982-11eb-88dd-f06655f6121a.png" alt="image"></p><h3>FAQ</h3></p><p>#### D: Il titolo dell'intestazione di Excel non è uguale al nome della proprietà della classe, come mappare?</p><p>R. Si prega di utilizzare l'attributo ExcelColumnName</p><p><img src="https://user-images.githubusercontent.com/12729184/116020475-eac50980-a678-11eb-8804-129e87200e5e.png" alt="image"></p><p>#### D. Come interrogare o esportare più fogli?</p><p>R. Metodo </code>GetSheetNames<code> con parametro sheetName di Query.</p><pre><code class="language-csharp">var sheets = MiniExcel.GetSheetNames(path);
foreach (var sheet in sheets)
{
    Console.WriteLine($"sheet name : {sheet} ");
    var rows = MiniExcel.Query(path,useHeaderRow:true,sheetName:sheet);
    Console.WriteLine(rows);
}</code></pre>
<img src="https://user-images.githubusercontent.com/12729184/116199841-2a1f5300-a76a-11eb-90a3-6710561cf6db.png" alt="image"></p><p>#### D. Come interrogare o esportare informazioni sulla visibilità dei fogli?</p><p>R. Metodo </code>GetSheetInformations<code>.</p><pre><code class="language-csharp">var sheets = MiniExcel.GetSheetInformations(path);
foreach (var sheetInfo in sheets)
{
    Console.WriteLine($"sheet index : {sheetInfo.Index} "); // next sheet index - numbered from 0
    Console.WriteLine($"sheet name : {sheetInfo.Name} ");   // sheet name
    Console.WriteLine($"sheet state : {sheetInfo.State} "); // sheet visibility state - visible / hidden
}</code></pre></p><p>#### D. Come compilare i dati orizzontalmente (da sinistra a destra) con i modelli?</p><p>R. Il rendering della raccolta di modelli MiniExcel si espande verticalmente (dall'alto verso il basso). Il riempimento orizzontale (da sinistra a destra) non è ancora supportato (vedi https://github.com/mini-software/MiniExcel/issues/619).</p><p>Se ti serve solo il layout finale, trasponi i tuoi dati in una matrice ed esportali con </code>printHeader: false<code>:</p><pre><code class="language-csharp">var employees = new[]
{
    new { Name = "Name1", Department = "Department1", City = "City1", Country = "Country1" },
    new { Name = "Name2", Department = "Department2", City = "City2", Country = "Country2" },
    new { Name = "Name3", Department = "Department3", City = "City3", Country = "Country3" },
};</p><p>var table = new DataTable();
table.Columns.Add("A");
for (var i = 0; i < employees.Length; i++)
    table.Columns.Add($"B{i + 1}");</p><p>table.Rows.Add(new object[] { "Name" }.Concat(employees.Select(e => (object)e.Name)).ToArray());
table.Rows.Add(new object[] { "Department" }.Concat(employees.Select(e => (object)e.Department)).ToArray());
table.Rows.Add(new object[] { "City" }.Concat(employees.Select(e => (object)e.City)).ToArray());
table.Rows.Add(new object[] { "Country" }.Concat(employees.Select(e => (object)e.Country)).ToArray());</p><p>MiniExcel.SaveAs(path, table, printHeader: false);</code></pre></p><p>Se devi utilizzare un template per lo stile, una opzione è usare segnaposto scalari (ad es. </code>{{Name_1}}<code>, </code>{{Name_2}}<code> ...) e riempire un dizionario (richiede un numero massimo fisso di colonne).</p><p>
#### D. L'utilizzo di Count carica tutti i dati in memoria?</p><p>No, il test con immagini ha 1 milione di righe*10 colonne di dati, l'utilizzo massimo della memoria è <60MB e impiega 13,65 secondi</p><p><img src="https://user-images.githubusercontent.com/12729184/117118518-70586000-adc3-11eb-9ce3-2ba76cf8b5e5.png" alt="image"></p><p>#### D. Come Query utilizza indici interi?</p><p>L'indice predefinito di Query è la chiave stringa: A,B,C.... Se vuoi cambiare ad un indice numerico, crea il seguente metodo per convertire</p><pre><code class="language-csharp">void Main()
{
    var path = @"D:\git\MiniExcel\samples\xlsx\TestTypeMapping.xlsx";
    var rows = MiniExcel.Query(path,true);
    foreach (var r in ConvertToIntIndexRows(rows))
    {
        Console.Write($"column 0 : {r[0]} ,column 1 : {r[1]}");
        Console.WriteLine();
    }
}</p><p>private IEnumerable<Dictionary<int, object>> ConvertToIntIndexRows(IEnumerable<object> rows)
{
    ICollection<string> keys = null;
    var isFirst = true;
    foreach (IDictionary<string,object> r in rows)
    {
        if(isFirst)
        {
            keys = r.Keys;
            isFirst = false;
        }</p><p>        var dic = new Dictionary<int, object>();
        var index = 0;
        foreach (var key in keys)
            dic[index++] = r[key];
        yield return dic;
    }
}</code></pre>
#### D. Nessun titolo, Excel vuoto viene generato quando il valore è vuoto durante l'esportazione in Excel</p><p>Poiché MiniExcel utilizza una logica simile a JSON.NET per ottenere dinamicamente il tipo dai valori al fine di semplificare le operazioni API, il tipo non può essere conosciuto senza dati. Puoi consultare <a href="https://github.com/mini-software/MiniExcel/issues/133" target="_blank" rel="noopener noreferrer">issue #133</a> per ulteriori informazioni.</p><p><img src="https://user-images.githubusercontent.com/12729184/122639771-546c0c00-d12e-11eb-800c-498db27889ca.png" alt="image"></p><blockquote>Tipi forti e DataTable genereranno intestazioni, ma i Dictionary risulteranno comunque Excel vuoti</blockquote></p><p>#### D. Come interrompere il foreach quando c'è una riga vuota?</p><p>MiniExcel può essere usato con </code>LINQ TakeWhile<code> per interrompere l'iterazione foreach.</p><p><img src="https://user-images.githubusercontent.com/12729184/130209137-162621c2-f337-4479-9996-beeac65bc4d4.png" alt="Image"></p><p>#### D. Come rimuovere le righe vuote?</p><p><img src="https://user-images.githubusercontent.com/12729184/137873865-7107d8f5-eb59-42db-903a-44e80589f1b2.png" alt="image"></p><p>
IEnumerable :</p><pre><code class="language-csharp">public static IEnumerable<dynamic> QueryWithoutEmptyRow(Stream stream, bool useHeaderRow, string sheetName, ExcelType excelType, string startCell, IConfiguration configuration)
{
    var rows = stream.Query(useHeaderRow,sheetName,excelType,startCell,configuration);
    foreach (IDictionary<string,object> row in rows)
    {
        if(row.Keys.Any(key=>row[key]!=null))
            yield return row;
    }
}</code></pre></p><p>
DataTable :</p><pre><code class="language-csharp">public static DataTable QueryAsDataTableWithoutEmptyRow(Stream stream, bool useHeaderRow, string sheetName, ExcelType excelType, string startCell, IConfiguration configuration)
{
    if (sheetName == null && excelType != ExcelType.CSV) /<em>Issue #279</em>/
        sheetName = stream.GetSheetNames().First();</p><p>    var dt = new DataTable(sheetName);
    var first = true;
    var rows = stream.Query(useHeaderRow,sheetName,excelType,startCell,configuration);
    foreach (IDictionary<string, object> row in rows)
    {
        if (first)
        {</p><p>            foreach (var key in row.Keys)
            {
                var column = new DataColumn(key, typeof(object)) { Caption = key };
                dt.Columns.Add(column);
            }</p><p>            dt.BeginLoadData();
            first = false;
        }</p><p>        var newRow = dt.NewRow();
        var isNull=true;
        foreach (var key in row.Keys)
        {
            var _v = row[key];
            if(_v!=null)
                isNull = false;
            newRow[key] = _v;
        }</p><p>        if(!isNull)
            dt.Rows.Add(newRow);
    }</p><p>    dt.EndLoadData();
    return dt;
}</code></pre></p><p>
#### D. Come usare SaveAs(path,value) per sostituire un file esistente senza generare l'errore "Il file ...xlsx esiste già"</p><p>
Si prega di utilizzare la classe Stream per personalizzare la logica di creazione del file, ad esempio:</p><p>
</code>`<code>C#
    using (var stream = File.Create("Demo.xlsx"))
        MiniExcel.SaveAs(stream,value);
<pre><code class="language-"></p><p>oppure, dalla versione V1.25.0, SaveAs supporta il parametro overwriteFile per abilitare/disabilitare la sovrascrittura di un file esistente</p><p></code></pre>csharp
    MiniExcel.SaveAs(path, value, overwriteFile: true);
</code>``</p><h3>Limitazioni e avvertenze</h3></p><ul><li>Attualmente non supporta file xls e file criptati</li>
<li>xlsm supporta solo Query</li></p><p></ul><h3>Riferimenti</h3></p><p><a href="https://github.com/ExcelDataReader/ExcelDataReader" target="_blank" rel="noopener noreferrer">ExcelDataReader</a>  / <a href="https://github.com/ClosedXML/ClosedXML" target="_blank" rel="noopener noreferrer">ClosedXML</a> / <a href="https://github.com/DapperLib/Dapper" target="_blank" rel="noopener noreferrer">Dapper</a> / <a href="https://github.com/andersnm/ExcelNumberFormat" target="_blank" rel="noopener noreferrer">ExcelNumberFormat</a></p><h3>Ringraziamenti</h3></p><p>####  <a href="https://www.jetbrains.com/" target="_blank" rel="noopener noreferrer">Jetbrains</a></p><p><img src="https://user-images.githubusercontent.com/12729184/123997015-8456c180-da02-11eb-829a-aec476fe8e94.png" alt="jetbrains-variant-2"></p><p>Grazie per aver fornito gratuitamente la licenza All product IDE per questo progetto (<a href="https://user-images.githubusercontent.com/12729184/123988233-6ab17c00-d9fa-11eb-8739-2a08c6a4a263.png" target="_blank" rel="noopener noreferrer">Licenza</a>)</p><h3>Donazioni per la condivisione dei contributi</h3>
Link https://github.com/orgs/mini-software/discussions/754</p><h3>Contributori</h3></p><p><img src="https://contrib.rocks/image?repo=mini-software/MiniExcel" alt=""></p><p>

---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2026-03-01

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/mini-software/MiniExcel/master/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2026-03-01 
    </div>
    
</body>
</html>