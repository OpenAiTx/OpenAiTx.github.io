<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mirror - Mirror est un package &#233;l&#233;gant d&#39;usurpation d&#39;identit&#233; utilisateur pour Laravel. Il permet aux administrateurs de se connecter facilement en tant qu&#39;autres utilisateurs pour r&#233;soudre des probl&#232;mes, fournir du support ou tester l&#39;exp&#233;rience utilisateur.</title>
    <meta name="description" content="Mirror est un package &#233;l&#233;gant d&#39;usurpation d&#39;identit&#233; utilisateur pour Laravel. Il permet aux administrateurs de se connecter facilement en tant qu&#39;autres utilisateurs pour r&#233;soudre des probl&#232;mes, fournir du support ou tester l&#39;exp&#233;rience utilisateur.">
    <meta name="keywords" content="mirror, French, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "mirror",
  "description": "Mirror est un package élégant d'usurpation d'identité utilisateur pour Laravel. Il permet aux administrateurs de se connecter facilement en tant qu'autres utilisateurs pour résoudre des problèmes, fournir du support ou tester l'expérience utilisateur.",
  "author": {
    "@type": "Person",
    "name": "franbarbalopez"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 74
  },
  "url": "https://OpenAiTx.github.io/projects/franbarbalopez/mirror/README-fr.html",
  "sameAs": "https://raw.githubusercontent.com/franbarbalopez/mirror/master/README.md",
  "datePublished": "2025-12-07",
  "dateModified": "2025-12-07"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/franbarbalopez/mirror" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    mirror
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 74 stars</span>
                <span class="language">French</span>
                <span>by franbarbalopez</span>
            </div>
        </div>
        
        <div class="content">
            <p><img src="https://raw.githubusercontent.com/franbarbalopez/mirror/master/art/logo.png" alt="Logo Mirror"></p><p><div align="center">
    <img alt="Dernière version sur Packagist" src="https://img.shields.io/packagist/v/franbarbalopez/mirror.svg">
    <img alt="Statut des tests GitHub Actions" src="https://img.shields.io/github/actions/workflow/status/franbarbalopez/mirror/tests.yml?label=tests">
    <img alt="Nombre total de téléchargements" src="https://img.shields.io/packagist/dt/franbarbalopez/mirror.svg">
    <img alt="Licence" src="https://img.shields.io/packagist/l/franbarbalopez/mirror.svg">
</div></p><h1>Mirror</h1></p><p>Mirror est un package d'usurpation d'utilisateur élégant pour Laravel. Il permet aux administrateurs de se connecter facilement en tant qu'autres utilisateurs pour résoudre des problèmes, fournir du support ou tester l'expérience utilisateur. Mirror gère l'intégrité des sessions avec une vérification cryptographique, une expiration automatique, un support multi-gardes, un middleware flexible et des événements de cycle de vie pour la journalisation d'audit. Parfait pour les applications en production nécessitant une usurpation d'utilisateur fiable et sécurisée.</p><h2>Fonctionnalités</h2></p><ul><li>Intégrité de session HMAC-SHA256 pour prévenir toute falsification</li>
<li>Expiration TTL configurable</li>
<li>Middleware pour le contrôle d'accès et l'application du TTL</li>
<li>Support multi-gardes</li>
<li>Redirection d'URL flexible</li>
<li>Événements de cycle de vie pour la journalisation d'audit</li></p><p></ul><h2>Exigences</h2></p><ul><li>PHP 8.2+</li>
<li>Laravel 11+</li></p><p></ul><h2>Installation</h2></p><pre><code class="language-bash">composer require franbarbalopez/mirror</code></pre>
Optionnel - publier le fichier de configuration :</p><pre><code class="language-bash">php artisan vendor:publish --tag=mirror</code></pre></p><h2>Démarrage rapide</h2></p><h3>1. Ajouter un Trait au Modèle Utilisateur</h3></p><pre><code class="language-php">use Illuminate\Foundation\Auth\User as Authenticatable;
use Mirror\Concerns\Impersonatable;</p><p>class User extends Authenticatable
{
    use Impersonatable;</p><p>    public function canImpersonate(): bool
    {
        return $this->hasRole('admin');
    }</p><p>    public function canBeImpersonated(): bool
    {
        return ! $this->hasRole('super-admin');
    }
}</code></pre></p><p><strong>Important :</strong> Si vous n’implémentez pas <code>canImpersonate()</code>, tout le monde peut se faire passer pour n’importe qui. Le trait retourne <code>true</code> par défaut.</p><h3>2. Commencer à usurper l’identité</h3></p><pre><code class="language-php">use Mirror\Facades\Mirror;</p><p>public function impersonate(User $user)
{
    Mirror::start($user);</p><p>    return redirect()->route('dashboard');
}</code></pre></p><h3>3. Cessez d'usurper l'identité</h3></p><pre><code class="language-php">public function leave()
{
    Mirror::stop();</p><p>    return redirect()->route('admin.users.index');
}</code></pre></p><h2>Sécurité</h2></p><p>Les sessions d'usurpation sont protégées par des hachages HMAC-SHA256 utilisant la clé de votre application. Le hachage couvre l'ID de l'usurpateur, le nom du garde, l'heure de début et l'URL de redirection. À chaque appel de <code>stop()</code>, Mirror vérifie ce hachage - si quelqu'un a altéré la session, il lance une exception et efface tout.</p><p>Configurez le TTL dans <code>config/mirror.php</code> pour expirer automatiquement les sessions après un temps défini.</p><h2>Référence API</h2></p><h3>Démarrer une usurpation</h3></p><p>Par instance utilisateur :</p><pre><code class="language-php">Mirror::start($user);</p><p>// With redirect URLs
$redirectUrl = Mirror::start(
    user: $targetUser,
    leaveRedirectUrl: route('admin.users.index'),
    startRedirectUrl: route('dashboard')
);</p><p>return redirect($redirectUrl);</code></pre></p><p>Par clé primaire (fonctionne avec int, UUID, ULID, etc.) :</p><pre><code class="language-php">Mirror::startByKey(123);</p><p>Mirror::startByKey('550e8400-e29b-41d4-a716-446655440000');</code></pre>
Par courriel :</p><pre><code class="language-php">Mirror::startByEmail('user@example.com');</code></pre></p><h3>Arrêt de l'usurpation d'identité</h3></p><pre><code class="language-php">Mirror::stop();</p><p>// Force stop - bypasses TTL check but still verifies integrity
Mirror::forceStop();</code></pre></p><p>Utilisez <code>forceStop()</code> lorsque vous devez mettre fin à l'usurpation depuis des actions d'administration ou des scripts de nettoyage - cela ignore la vérification TTL mais génère toujours une erreur si la session a été altérée.</p><h3>Vérification de l'état</h3></p><pre><code class="language-php">Mirror::isImpersonating(): bool
Mirror::getImpersonator(): ?Authenticatable
Mirror::impersonatorId(): int|string|null
Mirror::getLeaveRedirectUrl(): ?string</code></pre></p><h3>Alias</h3></p><pre><code class="language-php">Mirror::as($user);           // same as start()
Mirror::leave();             // same as stop()
Mirror::impersonating();     // same as isImpersonating()
Mirror::impersonator();      // same as getImpersonator()</code></pre></p><h2>Middleware</h2></p><h3><code>mirror.ttl</code></h3></p><p>Vérifie si la session d'usurpation a expiré et appelle automatiquement <code>stop()</code> si nécessaire :</p><pre><code class="language-php">Route::middleware('mirror.ttl')->group(function () {
    Route::get('/admin/users', [UserController::class, 'index']);
    Route::get('/admin/users/{user}', [UserController::class, 'show']);
});</code></pre></p><p>Utile pour protéger les zones d'administration sensibles où vous souhaitez que les sessions expirées se terminent proprement. Notez que lorsque le TTL expire, ce middleware met fin à l'usurpation d'identité et redirige, assurez-vous donc que le nettoyage de votre session est correctement configuré.</p><h3><code>mirror.require</code></h3></p><p>N'autorise l'accès que si une usurpation d'identité est active :</p><pre><code class="language-php">Route::middleware('mirror.require')->group(function () {
    Route::get('/impersonation/banner', function () {
        return view('impersonation.banner');
    });
});</code></pre>
Utile pour les composants UI spéciaux qui n'ont de sens que lors de l'usurpation d'identité - comme une bannière indiquant qui vous usurpez.</p><h3><code>mirror.prevent</code></h3></p><p>Bloque l'accès pendant l'usurpation d'identité :</p><pre><code class="language-php">Route::middleware('mirror.prevent')->group(function () {
    Route::post('/admin/users/{user}/delete', [UserController::class, 'destroy']);
    Route::get('/admin/settings', [SettingsController::class, 'edit']);
});</code></pre></p><p>Protège les actions destructrices ou les paramètres sensibles qui ne doivent être accessibles qu'en tant qu'utilisateur original, et non lors de l'usurpation d'identité d'une autre personne.</p><h2>Autorisation</h2></p><p>Le trait <code>Impersonatable</code> fournit deux méthodes qui retournent toutes deux <code>true</code> par défaut. Surchargez-les pour ajouter votre propre logique :</p><pre><code class="language-php">use Mirror\Concerns\Impersonatable;</p><p>class User extends Authenticatable
{
    use Impersonatable;</p><p>    public function canImpersonate(): bool
    {
        return $this->hasRole('admin');
    }</p><p>    public function canBeImpersonated(): bool
    {
        return ! $this->hasRole('super-admin');
    }
}</code></pre></p><p>Vous n'avez pas besoin du trait - Mirror recherchera ces méthodes sur votre modèle utilisateur quoi qu'il arrive :</p><pre><code class="language-php">class User extends Authenticatable
{
    public function canImpersonate(): bool
    {
        return $this->hasPermission('impersonate-users');
    }</p><p>    public function canBeImpersonated(): bool
    {
        return ! $this->is_system_account;
    }
}</code></pre></p><h2>Redirection d’URL</h2></p><p>Vous pouvez contrôler où les utilisateurs vont lorsqu’ils commencent et arrêtent l’usurpation d’identité :</p><pre><code class="language-php">public function impersonate(User $user)
{
    $redirectUrl = Mirror::start(
        user: $user,
        leaveRedirectUrl: route('admin.users.index'),  // where to go when they stop
        startRedirectUrl: route('dashboard')            // where to go right now
    );</p><p>    return redirect($redirectUrl);
}</p><p>public function leave()
{
    Mirror::stop();</p><p>    return redirect(Mirror::getLeaveRedirectUrl());
}</code></pre></p><p>Si vous ne spécifiez pas <code>leaveRedirectUrl</code>, il prend par défaut l'URL actuelle où <code>start()</code> a été appelé.</p><h2>Événements</h2></p><p>Mirror déclenche deux événements auxquels vous pouvez vous abonner :</p><ul><li><code>Mirror\Events\ImpersonationStarted</code></li>
<li><code>Mirror\Events\ImpersonationStopped</code></li></p><p></ul>Les deux événements contiennent l'utilisateur usurpateur, l'utilisateur cible, et le nom du garde. Utile pour les journaux d'audit ou le déclenchement de workflows.</p><p>Les événements sont déclenchés <strong>après que la réponse</strong> a été envoyée au client, garantissant que les opérations critiques d'usurpation se terminent sans délai. Ceci est particulièrement important pour les middlewares comme <code>mirror.ttl</code> qui peuvent s'exécuter à chaque requête.</p><pre><code class="language-php">use Mirror\Events\ImpersonationStarted;</p><p>Event::listen(ImpersonationStarted::class, function (ImpersonationStarted $event) {
    // Log the activity to your audit system of choice
    Log::info('User impersonation started', [
        'impersonator_id' => $event->impersonator->id,
        'impersonated_id' => $event->impersonated->id,
        'guard' => $event->guardName,
    ]);
});</code></pre></p><h2>Performance et optimisation</h2></p><p>Mirror est optimisé pour les applications à haute performance :</p><h3>Mise en cache à l’échelle de la requête</h3></p><p>Le modèle d’usurpation est mis en cache au sein d’une seule requête pour éviter les requêtes redondantes à la base de données :</p><pre><code class="language-php">// This first call will query the database
$impersonator = Mirror::getImpersonator();</p><p>// Subsequent calls in the same request use the cached instance, therefore this one will not:
$impersonator = Mirror::getImpersonator();</code></pre></p><p>Cela est particulièrement bénéfique pour les middlewares comme <code>mirror.ttl</code> qui s'exécutent à chaque requête.</p><h3>Diffusion différée des événements</h3></p><p>Les événements d'usurpation d'identité sont diffusés après l'envoi de la réponse au client, garantissant que les écouteurs d'événements n'impactent pas le temps de réponse. Cela maintient votre cycle de requête rapide tout en permettant la journalisation d'audit et d'autres tâches en arrière-plan.</p><h2>Support Multi-Guard</h2></p><p>Mirror détecte automatiquement quel garde vous utilisez :</p><pre><code class="language-php">Auth::guard('admin')->login($admin);</p><p>Mirror::start($user); // uses 'admin' guard</p><p>Mirror::stop(); // restores to 'admin' guard</code></pre></p><p>Vous n'avez pas besoin de spécifier manuellement le garde - il le déduit du contexte d'authentification actuel.</p><h2>Directives Blade</h2></p><p><strong>@impersonating</strong></p><pre><code class="language-blade">@impersonating
    <div class="alert">
        You're impersonating {{ auth()->user()->name }}.
        <a href="{{ route('impersonation.leave') }}">Exit</a>
    </div>
@endimpersonating</p><p>{{-- Check specific guard --}}
@impersonating('admin')
    <div>Impersonating via admin guard</div>
@endimpersonating</code></pre></p><p><strong>@peuxJeUsurper</strong></p><pre><code class="language-blade">@canImpersonate
    <a href="{{ route('admin.users.index') }}">Manage Users</a>
@endcanImpersonate</p><p>{{-- With guard --}}
@canImpersonate('admin')
    <div>Admin tools</div>
@endcanImpersonate</code></pre></p><p><strong>@peutÊtreUsurpé</strong></p><pre><code class="language-blade">{{-- Check current user --}}
@canBeImpersonated
    <span>Available for support</span>
@endcanBeImpersonated</p><p>{{-- Check specific user --}}
@canBeImpersonated($user)
    <form method="POST" action="{{ route('impersonation.start', $user) }}">
        @csrf
        <button>Impersonate</button>
    </form>
@endcanBeImpersonated</p><p>{{-- With guard --}}
@canBeImpersonated($user, 'admin')
    <button>Login as this user</button>
@endcanBeImpersonated</code></pre></p><h2>Licence</h2></p><p>MIT. Voir <a href="https://raw.githubusercontent.com/franbarbalopez/mirror/master/LICENSE.md" target="_blank" rel="noopener noreferrer">LICENSE.md</a>.</p><h2>Crédits</h2></p><p>Développé par <a href="https://github.com/franbarbalopez" target="_blank" rel="noopener noreferrer">franbarbalopez</a>.</p><p>
---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-12-07

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/franbarbalopez/mirror/master/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-12-07 
    </div>
    
</body>
</html>