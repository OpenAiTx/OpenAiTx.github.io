<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>coffi - Une interface de fonction &#233;trang&#232;re en Clojure pour JDK 22+.</title>
    <meta name="description" content="Une interface de fonction &#233;trang&#232;re en Clojure pour JDK 22+.">
    <meta name="keywords" content="coffi, French, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "coffi",
  "description": "Une interface de fonction étrangère en Clojure pour JDK 22+.",
  "author": {
    "@type": "Person",
    "name": "IGJoshua"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 357
  },
  "url": "https://OpenAiTx.github.io/projects/IGJoshua/coffi/README-fr.html",
  "sameAs": "https://raw.githubusercontent.com/IGJoshua/coffi/develop/README.md",
  "datePublished": "2025-11-30",
  "dateModified": "2025-11-30"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/IGJoshua/coffi" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    coffi
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 357 stars</span>
                <span class="language">French</span>
                <span>by IGJoshua</span>
            </div>
        </div>
        
        <div class="content">
            <h1>coffi</h1>
<a href="https://clojars.org/org.suskalo/coffi" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/clojars/v/org.suskalo/coffi.svg" alt="Projet Clojars"></a>
<a href="https://cljdoc.org/d/org.suskalo/coffi" target="_blank" rel="noopener noreferrer"><img src="https://cljdoc.org/badge/org.suskalo/coffi" alt="badge cljdoc"></a></p><p>Coffi est une bibliothèque d'interface de fonction étrangère pour Clojure, utilisant l'<a href="https://openjdk.org/jeps/454" target="_blank" rel="noopener noreferrer">API de fonction et mémoire étrangères</a> dans JDK 22 et versions ultérieures. Cela permet d'appeler du code natif directement depuis Clojure sans besoin de code Java ou natif spécifique à la bibliothèque, comme le fait par exemple JNI. Coffi met l'accent sur la facilité d'utilisation, incluant des fonctions et macros pour créer des wrappers permettant aux fonctions natives résultantes d'agir comme des fonctions Clojure, cependant cela n'empêche pas d'écrire des systèmes qui minimisent le coût de la sérialisation des données et optimisent la performance, pour exploiter l'accès bas niveau que l'API FF&M nous offre.</p><ul><li><a href="https://cljdoc.org/d/org.suskalo/coffi/CURRENT/doc/getting-started" target="_blank" rel="noopener noreferrer">Commencer</a></li>
<li><a href="https://cljdoc.org/d/org.suskalo/coffi/CURRENT/api/coffi" target="_blank" rel="noopener noreferrer">Documentation API</a></li>
<li><a href="https://raw.githubusercontent.com/IGJoshua/coffi/develop/CHANGELOG.md" target="_blank" rel="noopener noreferrer">Modifications récentes</a></li></p><p></ul><h2>Installation</h2>
Cette bibliothèque est disponible sur Clojars, ou en tant que dépendance git. Ajoutez une des entrées suivantes à la clé <code>:deps</code> de votre <code>deps.edn</code> :</p><pre><code class="language-clojure">org.suskalo/coffi {:mvn/version "1.0.615"}
io.github.IGJoshua/coffi {:git/tag "v1.0.615" :git/sha "7401485"}</code></pre></p><p>Si vous utilisez cette bibliothèque comme dépendance git, vous devrez préparer la
bibliothèque.</p><pre><code class="language-sh">$ clj -X:deps prep</code></pre>
Coffi nécessite l’utilisation du paquet <code>java.lang.foreign</code>, et la plupart des  
opérations sont considérées comme non sécurisées par le JDK, et sont donc  
inaccessibles à votre code sans passer certains arguments en ligne de commande.  
Pour utiliser coffi, ajoutez les arguments JVM suivants à votre application.</p><pre><code class="language-sh">--enable-native-access=ALL-UNNAMED</code></pre></p><p>Vous pouvez spécifier des arguments JVM dans une invocation particulière du Clojure CLI avec
le drapeau <code>-J</code> de cette manière :</p><p>``<code> sh
clj -J--enable-native-access=ALL-UNNAMED
<pre><code class="language-">
Vous pouvez également les spécifier dans un alias dans votre fichier </code>deps.edn<code> sous la clé
</code>:jvm-opts<code> (voir l'exemple suivant) puis invoquer l'interface CLI avec cet alias
en utilisant </code>-M<code>, </code>-A<code> ou </code>-X<code>.
</code></pre> clojure
{:aliases {:dev {:jvm-opts ["--enable-native-access=ALL-UNNAMED"]}}}
<pre><code class="language-">
D'autres outils de construction devraient fournir une fonctionnalité similaire si vous consultez leur
documentation.</p><p>Lors de la création d'un fichier jar exécutable, vous pouvez éviter la nécessité de passer cet
argument en ajoutant l'attribut de manifeste </code>Enable-Native-Access: ALL-UNNAMED<code> à
votre jar. Consultez la documentation de votre outil de construction pour savoir comment l'ajouter.</p><p>Coffi inclut également le support pour le linter clj-kondo. Si vous utilisez clj-kondo et que
les macros de cette bibliothèque ne sont pas analysées correctement, vous devrez peut-être installer la
configuration fournie avec la bibliothèque. Vous pouvez le faire avec la commande shell suivante,
exécutée depuis le répertoire de votre projet :
</code></pre>sh
$ clj-kondo --copy-configs --dependencies --lint "$(clojure -Spath)"
<pre><code class="language-">
<h2>Utilisation</h2>
Les deux principaux espaces de noms sont </code>coffi.mem<code> qui fournit des fonctions pour allouer
et manipuler la mémoire hors tas ainsi que (dé)sérialiser des valeurs, et </code>coffi.ffi<code>
qui peut charger des bibliothèques natives, déclarer des wrappers de fonctions natives, et
(dé)sérialiser des fonctions en tant que callbacks.
</code></pre>clojure
(require '[coffi.mem :as mem])
(require '[coffi.ffi :as ffi :refer [defcfn]])</p><p>(defcfn strlen
  "Given a string, measures its length in bytes."
  strlen [::mem/c-string] ::mem/long)</p><p>(strlen "hello")
;; => 5</p><p>(ffi/load-system-library "z")
</code>`<code>
Dans l’espace de noms </code>coffi.mem<code>, il existe des types pour tous les types numériques primitifs signés en C, plus </code>::mem/pointer<code> et </code>::mem/c-string<code>, ainsi que des moyens d’utiliser des déclarations de type de style malli pour définir des structs, unions, tableaux, enums et ensembles de flags.</p><h2>Alternatives  </h2>
Cette bibliothèque n’est pas la seule bibliothèque Clojure offrant un accès au code natif. En outre, les bibliothèques suivantes (entre autres) existent :</p><ul><li><a href="https://github.com/cnuernber/dtype-next" target="_blank" rel="noopener noreferrer">dtype-next</a>  </li>
<li><a href="https://github.com/techascent/tech.jna" target="_blank" rel="noopener noreferrer">tech.jna</a>  </li>
<li><a href="https://github.com/Chouser/clojure-jna" target="_blank" rel="noopener noreferrer">clojure-jna</a>  </li></p><p></ul>Dtype-next prend en charge les versions Java 8-15, 17+, et GraalVM, mais est fortement axé sur la programmation basée sur les tableaux, ainsi que sur le maintien de la mémoire côté natif plutôt que sur le passage des données vers et depuis des structures natives de Clojure. En Java 17+, il utilise l’API Foreign Function & Memory (une partie du projet Panama jusqu’à sa stabilisation dans JDK 22), tandis que dans d’autres versions de Java, il utilise JNA.</p><p>Tech.jna et clojure-jna utilisent tous deux la bibliothèque JNA dans tous les cas, et aucun ne fournit de support explicite pour les callbacks. JNA permet l’utilisation de </code>java.nio.ByteBuffer<code>s pour passer des structs par valeur, et les deux bibliothèques offrent des moyens d’utiliser cette construction par valeur pour appeler des API par référence.</p><p>Une autre alternative à coffi est d’utiliser directement le JNI, qui est la méthode la plus ancienne d’encapsulation du code natif dans la JVM, mais présente l’inconvénient de nécessiter d’écrire à la fois du code natif et du code Java, même si vous ne souhaitez l’utiliser qu’à partir de Clojure.</p><p>Si votre application doit pouvoir s’exécuter sur des versions antérieures de la JVM à la 22, vous devriez envisager ces autres options. Dtype-next offre le support le plus robuste pour le code natif, mais si vous encapsulez une bibliothèque simple, les autres bibliothèques peuvent être plus attrayantes, car elles ont une surface d’API plus petite et il est plus facile d’encapsuler des fonctions.</p><p>Il existe également un <a href="https://docs.google.com/spreadsheets/d/1ViLHNUgrO2osh2AH0h7MaCaXz8g0UpLbyWojY5f10kk/edit?gid=332155605#gid=332155605" target="_blank" rel="noopener noreferrer">tour d’horizon tiers</a> des options FFI pour Clojure.</p><h2>Problèmes connus</h2>
L'auteur du projet est conscient de ces problèmes et prévoit de les corriger dans une future
version :</p><ul><li>Lors de la génération de la documentation avec codox dans une bibliothèque qui dépend de coffi, l'erreur ci-dessous sera produite. Une solution temporaire consiste à ajouter une dépendance explicite dans votre build codox sur insn en version 0.2.1</li>
  </ul></code>`<code>
  Unable to find static field: ACC_OPEN in interface org.objectweb.asm.Opcodes
  </code>``
<h2>Plans Futurs</h2>
Ces fonctionnalités sont prévues pour les futures versions.</p><ul><li>Prise en charge du type va_args</li>
<li>Outil d'analyse d'en-tête pour générer un modèle de données ? (peut-être simplement travailler avec <a href="https://github.com/phronmophobic/clong" target="_blank" rel="noopener noreferrer">clong</a> ?)</li>
<li>Alias de types génériques</li>
<li>Types entiers non signés</li>
<li>Macro d’aide pour les arguments de sortie</li>
<li>Améliorer les messages d’erreur de la macro defcfn</li>
<li>Mémoire mappée</li>
<li>Macros d’aide pour les implémentations serde personnalisées pour des types de données plus composites</li>
<li>Prise en charge de GraalVM Native Image (une fois que leur support pour FFM sera mature)</li></p><p></ul><h2>Licence</h2></p><p>Droits d’auteur © 2023 Joshua Suskalo</p><p>Distribué sous la licence publique Eclipse version 1.0.</p><p>

---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2025-11-30

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/IGJoshua/coffi/develop/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2025-11-30 
    </div>
    
</body>
</html>