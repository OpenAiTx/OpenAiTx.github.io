<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapperatorinator - ИИ-фреймворк для создания и модификации beatmap&#39;ов osu! для всех игровых режимов на основе входных спектрограмм.</title>
    <meta name="description" content="ИИ-фреймворк для создания и модификации beatmap&#39;ов osu! для всех игровых режимов на основе входных спектрограмм.">
    <meta name="keywords" content="Mapperatorinator, Russian, documentation, GitHub, open source">
    <meta name="author" content="OpenAiTx">
    <meta name="robots" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Mapperatorinator",
  "description": "ИИ-фреймворк для создания и модификации beatmap'ов osu! для всех игровых режимов на основе входных спектрограмм.",
  "author": {
    "@type": "Person",
    "name": "OliBomby"
  },
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "5",
    "ratingCount": 398
  },
  "url": "https://OpenAiTx.github.io/projects/OliBomby/Mapperatorinator/README-ru.html",
  "sameAs": "https://raw.githubusercontent.com/OliBomby/Mapperatorinator/main/README.md",
  "datePublished": "2026-01-24",
  "dateModified": "2026-01-24"
}
    </script>
    
    <!-- GitHub-style CSS -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #ffffff;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .header {
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        
        .project-title {
            font-size: 2em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .project-title a {
            color: #24292e;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: color 0.2s ease;
        }
        
        .project-title a:hover {
            color: #0366d6;
            text-decoration: none;
        }
        
        .project-title .github-icon {
            width: 1em;
            height: 1em;
            fill: currentColor;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .project-title a:hover .github-icon {
            opacity: 1;
        }
        
        .project-meta {
            color: #586069;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .stars {
            display: inline-block;
            margin-right: 16px;
        }
        
        .language {
            display: inline-block;
            background-color: #f1f8ff;
            color: #0366d6;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .content {
            font-size: 16px;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, h5, h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: #24292e;
        }
        
        h1 { font-size: 2em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h2 { font-size: 1.5em; border-bottom: 1px solid #eaecef; padding-bottom: 0.3em; }
        h3 { font-size: 1.25em; }
        
        p {
            margin-bottom: 16px;
        }
        
        code {
            background-color: #f6f8fa;
            border-radius: 3px;
            font-size: 85%;
            margin: 0;
            padding: 0.2em 0.4em;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }
        
        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            font-size: 85%;
            line-height: 1.45;
            overflow: auto;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        pre code {
            background-color: transparent;
            border: 0;
            display: inline;
            line-height: inherit;
            margin: 0;
            overflow: visible;
            padding: 0;
            word-wrap: normal;
        }
        
        a {
            color: #0366d6;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        ul, ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }
        
        li {
            margin-bottom: 0.25em;
        }
        
        blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            margin: 0 0 16px 0;
            padding: 0 1em;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
            text-align: center;
        }
        
        .footer a {
            color: #0366d6;
        }
        
        .original-link {
            margin-top: 16px;
            padding: 12px;
            background-color: #f6f8fa;
            border-radius: 6px;
            border: 1px solid #e1e4e8;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 16px;
            }
            
            .project-title {
                font-size: 1.5em;
            }
        }
    </style>
    
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Bing Count -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "sh95yd6uwt");
    </script>        

    <!-- Statcounter -->
    <script type="text/javascript">
        var sc_project = 13142514;
        var sc_invisible = 1;
        var sc_security = "d03a31d8"; 
    </script>
    <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
    <noscript>
        <div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img
                    class="statcounter" src="https://c.statcounter.com/13142514/0/d03a31d8/1/" alt="Web Analytics"
                    referrerPolicy="no-referrer-when-downgrade"></a></div>
    </noscript>    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="project-title">
                <a href="https://github.com/OliBomby/Mapperatorinator" target="_blank" rel="noopener noreferrer">
                    <svg class="github-icon" viewBox="0 0 16 16" aria-hidden="true">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                    </svg>
                    Mapperatorinator
                </a>
            </h1>
            <div class="project-meta">
                <span class="stars">⭐ 398 stars</span>
                <span class="language">Russian</span>
                <span>by OliBomby</span>
            </div>
        </div>
        
        <div class="content">
            <p>
<div align="right">
  <details>
    <summary >🌐 Язык</summary>
    <div>
      <div align="center">
        <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=en">English</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=zh-CN">简体中文</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=zh-TW">繁體中文</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=ja">日本語</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=ko">한국어</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=hi">हिन्दी</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=th">ไทย</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=fr">Français</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=de">Deutsch</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=es">Español</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=it">Italiano</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=ru">Русский</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=pt">Português</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=nl">Nederlands</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=pl">Polski</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=ar">العربية</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=fa">فارسی</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=tr">Türkçe</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=vi">Tiếng Việt</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=id">Bahasa Indonesia</a>
        | <a href="https://openaitx.github.io/view.html?user=OliBomby&project=Mapperatorinator&lang=as">অসমীয়া</
      </div>
    </div>
  </details>
</div></p><h1>Mapperatorinator</h1></p><p>Попробуйте генеративную модель <a href="https://colab.research.google.com/github/OliBomby/Mapperatorinator/blob/main/colab/mapperatorinator_inference.ipynb" target="_blank" rel="noopener noreferrer">здесь</a> или MaiMod <a href="https://colab.research.google.com/github/OliBomby/Mapperatorinator/blob/main/colab/mai_mod_inference.ipynb" target="_blank" rel="noopener noreferrer">здесь</a>. Посмотрите видео-презентацию <a href="https://youtu.be/FEr7t1L2EoA" target="_blank" rel="noopener noreferrer">здесь</a>.</p><p>Mapperatorinator — это мультимодельная платформа, которая использует входные спектрограммы для генерации полноценных osu! битмапов для всех игровых режимов и <a href="#maimod-the-ai-driven-modding-tool" target="_blank" rel="noopener noreferrer">помогает моддить битмапы</a>.
Цель этого проекта — автоматически генерировать osu! битмапы рангового качества для любой песни с высокой степенью настраиваемости.</p><p>Этот проект построен на базе <a href="https://github.com/gyataro/osuT5" target="_blank" rel="noopener noreferrer">osuT5</a> и <a href="https://github.com/OliBomby/osu-diffusion" target="_blank" rel="noopener noreferrer">osu-diffusion</a>. В процессе разработки я потратил около 2500 часов вычислений на GPU в 142 прогонах на своей 4060 Ti и арендованных экземплярах 4090 через vast.ai.</p><p>#### Используйте этот инструмент ответственно. Всегда указывайте использование ИИ в ваших битмапах.</p><h2>Установка</h2></p><p>Инструкция ниже позволяет генерировать битмапы на вашем локальном компьютере, либо вы можете запустить её в облаке с помощью <a href="https://colab.research.google.com/github/OliBomby/Mapperatorinator/blob/main/colab/mapperatorinator_inference.ipynb" target="_blank" rel="noopener noreferrer">colab notebook</a>.</p><h3>1. Клонируйте репозиторий</h3></p><pre><code class="language-sh">git clone https://github.com/OliBomby/Mapperatorinator.git
cd Mapperatorinator</code></pre></p><h3>2. (Опционально) Создайте виртуальное окружение</h3></p><p>Используйте Python 3.10, более поздние версии могут быть несовместимы с зависимостями.</p><pre><code class="language-sh">python -m venv .venv</p><h1>In cmd.exe</h1>
.venv\Scripts\activate.bat
<h1>In PowerShell</h1>
.venv\Scripts\Activate.ps1
<h1>In Linux or MacOS</h1>
source .venv/bin/activate</code></pre></p><h3>3. Установите зависимости</h3></p><ul><li>Python 3.10</li>
<li><a href="https://git-scm.com/downloads" target="_blank" rel="noopener noreferrer">Git</a></li>
<li><a href="http://www.ffmpeg.org/" target="_blank" rel="noopener noreferrer">ffmpeg</a></li>
<li><a href="https://developer.nvidia.com/cuda-zone" target="_blank" rel="noopener noreferrer">CUDA</a> (для видеокарт NVIDIA) или <a href="https://rocmdocs.amd.com/en/latest/Installation_Guide/Installation-Guide.html" target="_blank" rel="noopener noreferrer">ROCm</a> (для видеокарт AMD на Linux)</li>
<li><a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener noreferrer">PyTorch</a>: Обязательно следуйте руководству Get Started, чтобы установить <code>torch</code> и <code>torchaudio</code> с поддержкой GPU. Выберите правильную версию Compute Platform, которую вы установили на предыдущем этапе.</li></p><p><li>и остальные зависимости Python:</li></p><p></ul><pre><code class="language-sh">pip install -r requirements.txt</code></pre></p><h2>Веб-интерфейс (рекомендуется)</h2></p><p>Для более удобного использования рекомендуется воспользоваться веб-интерфейсом. Он предоставляет графический интерфейс для настройки параметров генерации, запуска процесса и мониторинга результата.</p><h3>Запуск графического интерфейса</h3></p><p>Перейдите в склонированную директорию <code>Mapperatorinator</code> в вашем терминале и выполните:</p><pre><code class="language-sh">python web-ui.py</code></pre></p><p>Это запустит локальный веб-сервер и автоматически откроет пользовательский интерфейс в новом окне.</p><h3>Использование графического интерфейса</h3></p><ul><li><strong>Настроить:</strong> Укажите пути для входных/выходных данных с помощью полей формы и кнопок "Обзор". Отрегулируйте параметры генерации, такие как игровой режим, сложность, стиль (год, ID маппера, дескрипторы), тайминг, специфические функции (звуки ударов, супер-тайминг) и другие, аналогично опциям командной строки. (Примечание: если вы укажете <code>beatmap_path</code>, интерфейс автоматически определит <code>audio_path</code> и <code>output_path</code>, поэтому эти поля можно оставить пустыми)</li>
<li><strong>Запуск:</strong> Нажмите кнопку "Запустить инференс", чтобы начать генерацию карты.</li>
<li><strong>Отмена:</strong> Вы можете остановить текущий процесс, используя кнопку "Отменить инференс".</li>
<li><strong>Открыть выходные данные:</strong> После завершения используйте кнопку "Открыть папку с результатами" для быстрого доступа к сгенерированным файлам.</li></p><p></ul>Веб-интерфейс служит удобной оболочкой вокруг скрипта <code>inference.py</code>. Для расширенных опций или устранения неполадок обратитесь к инструкциям для командной строки.</p><p><img src="https://github.com/user-attachments/assets/5312a45f-d51c-4b37-9389-da3258ddd0a1" alt="python_u3zyW0S3Vs"></p><h2>Инференс через командную строку</h2></p><p>Для пользователей, предпочитающих командную строку или нуждающихся в расширенных настройках, выполните следующие шаги. <strong>Примечание:</strong> для более простого графического интерфейса смотрите раздел <a href="#web-ui-recommended" target="_blank" rel="noopener noreferrer">Веб-интерфейс (Рекомендуется)</a> выше.</p><p>Запустите <code>inference.py</code> и передайте аргументы для генерации карт. Для этого используйте <a href="https://hydra.cc/docs/advanced/override_grammar/basic/" target="_blank" rel="noopener noreferrer">синтаксис переопределения Hydra</a>. Все доступные параметры смотрите в <code>configs/inference_v29.yaml</code>.
<pre><code class="language-">python inference.py \
  audio_path           [Path to input audio] \
  output_path          [Path to output directory] \
  beatmap_path         [Path to .osu file to autofill metadata, and output_path, or use as reference] \
  
  gamemode             [Game mode to generate 0=std, 1=taiko, 2=ctb, 3=mania] \
  difficulty           [Difficulty star rating to generate] \
  mapper_id            [Mapper user ID for style] \
  year                 [Upload year to simulate] \
  hitsounded           [Whether to add hitsounds] \
  slider_multiplier    [Slider velocity multiplier] \
  circle_size          [Circle size] \
  keycount             [Key count for mania] \
  hold_note_ratio      [Hold note ratio for mania 0-1] \
  scroll_speed_ratio   [Scroll speed ratio for mania and ctb 0-1] \
  descriptors          [List of beatmap user tags for style] \
  negative_descriptors [List of beatmap user tags for classifier-free guidance] \
  
  add_to_beatmap       [Whether to add generated content to the reference beatmap instead of making a new beatmap] \
  start_time           [Generation start time in milliseconds] \
  end_time             [Generation end time in milliseconds] \
  in_context           [List of additional context to provide to the model [NONE,TIMING,KIAI,MAP,GD,NO_HS]] \
  output_type          [List of content types to generate] \
  cfg_scale            [Scale of the classifier-free guidance] \
  super_timing         [Whether to use slow accurate variable BPM timing generator] \
  seed                 [Random seed for generation] \</code></pre></p><p>Пример:
<pre><code class="language-">python inference.py beatmap_path="'C:\Users\USER\AppData\Local\osu!\Songs\1 Kenji Ninuma - DISCO PRINCE\Kenji Ninuma - DISCOPRINCE (peppy) [Normal].osu'" gamemode=0 difficulty=5.5 year=2023 descriptors="['jump aim','clean']" in_context=[TIMING,KIAI]</code></pre></p><h2>Интерактивный CLI</h2>
Для тех, кто предпочитает работу в терминале, но хочет получить пошаговую настройку, интерактивный скрипт CLI является отличной альтернативой веб-интерфейсу.</p><h3>Запуск CLI</h3>
Перейдите в склонированную директорию. Возможно, сначала потребуется сделать скрипт исполняемым.</p><pre><code class="language-sh"># Make the script executable (only needs to be done once)
chmod +x cli_inference.sh</code></pre></p><pre><code class="language-sh"># Run the script
./cli_inference.sh</code></pre></p><h3>Использование CLI</h3>
Скрипт проведет вас через серию подсказок для настройки всех параметров генерации, так же, как и Web UI.</p><p>Он использует цветовую кодировку для удобства восприятия.
Предоставляет расширенное многоуровневое меню для выбора дескрипторов стиля с помощью стрелок и пробела.
После ответа на все вопросы, он покажет итоговую команду для вашего просмотра.
Далее вы можете подтвердить выполнение команды напрямую или отменить и скопировать команду для ручного использования.</p><h2>Советы по генерации</h2></p><ul><li>Вы можете редактировать <code>configs/inference_v29.yaml</code> и добавлять свои аргументы туда, вместо того чтобы вводить их в терминале каждый раз.</li>
<li>Все доступные дескрипторы можно найти <a href="https://osu.ppy.sh/wiki/en/Beatmap/Beatmap_tags" target="_blank" rel="noopener noreferrer">здесь</a>.</li>
<li>Всегда указывайте год в диапазоне от 2007 до 2023. Если оставить его неизвестным, модель может сгенерировать неконсистентный стиль.</li>
<li>Всегда указывайте сложность. Если оставить ее неизвестной, модель может сгенерировать неконсистентную сложность.</li>
<li>Увеличьте параметр <code>cfg_scale</code>, чтобы повысить эффективность аргументов <code>mapper_id</code> и <code>descriptors</code>.</li>
<li>Можно использовать аргумент <code>negative_descriptors</code>, чтобы направить модель в сторону от определённых стилей. Это работает только при <code>cfg_scale > 1</code>. Убедитесь, что число негативных дескрипторов равно числу обычных дескрипторов.</li>
<li>Если стиль вашей песни и желаемый стиль карты плохо совпадают, модель может не следовать вашим указаниям. Например, сложно сгенерировать карту с высоким SR и SV для спокойной песни.</li>
<li>Если у вас уже готовы тайминги и моменты кайаи для песни, вы можете передать это модели для значительного ускорения и повышения точности вывода: используйте аргументы <code>beatmap_path</code> и <code>in_context=[TIMING,KIAI]</code>.</li>
<li>Чтобы перемапить только часть карты, используйте <code>beatmap_path</code>, <code>start_time</code>, <code>end_time</code> и <code>add_to_beatmap=true</code>.</li>
<li>Для генерации гостевой сложности для карты используйте <code>beatmap_path</code> и <code>in_context=[GD,TIMING,KIAI]</code>.</li>
<li>Для генерации hitsounds для карты используйте <code>beatmap_path</code> и <code>in_context=[NO_HS,TIMING,KIAI]</code>.</li>
<li>Для генерации только тайминга для песни используйте <code>super_timing=true</code> и <code>output_type=[TIMING]</code>.</li></p><p></ul><h2>MaiMod: инструмент моддинга на базе ИИ</h2></p><p>MaiMod — это инструмент моддинга для osu! карт, который использует предсказания Mapperatorinator для поиска потенциальных ошибок и несоответствий, которые не могут быть найдены другими автоматическими инструментами, такими как <a href="https://github.com/Naxesss/MapsetVerifier" target="_blank" rel="noopener noreferrer">Mapset Verifier</a>.
Он может обнаруживать такие проблемы, как:
<ul><li>Неправильная привязка или ритмические паттерны</li>
<li>Неточные тайминговые точки</li>
<li>Неконсистентные позиции объектов и новые комбо</li>
<li>Странные формы слайдеров</li>
<li>Неконсистентные hitsounds или громкости</li></p><p></ul>Вы можете попробовать MaiMod <a href="https://colab.research.google.com/github/OliBomby/Mapperatorinator/blob/main/colab/mai_mod_inference.ipynb" target="_blank" rel="noopener noreferrer">здесь</a> или запустить его локально:
Для локального запуска MaiMod вам нужно установить Mapperatorinator. Затем запустите скрипт <code>mai_mod.py</code>, указав путь к вашей карте с помощью аргумента <code>beatmap_path</code>.
<pre><code class="language-sh">python mai_mod.py beatmap_path="'C:\Users\USER\AppData\Local\osu!\Songs\1 Kenji Ninuma - DISCO PRINCE\Kenji Ninuma - DISCOPRINCE (peppy) [Normal].osu'"</code></pre>
Это выведет предложения по моддингу в консоль, которые затем можно применить к вашей карте вручную.
Предложения отсортированы по хронологии и сгруппированы по категориям.
Первое значение в круге указывает на «сюрпризальность» — меру того, насколько неожиданной модель сочла проблему, чтобы вы могли расставить приоритеты по важности.</p><p>Модель может ошибаться, особенно по вопросам с низкой сюрпризальностью, поэтому всегда перепроверяйте предложения перед их применением к вашей карте.
Основная цель — помочь вам сузить область поиска возможных проблем, чтобы не пришлось вручную проверять каждый объект в вашей карте.</p><h3>MaiMod GUI</h3>
Чтобы запустить MaiMod Web UI, вам потребуется установить Mapperatorinator.
Затем запустите скрипт <code>mai_mod_ui.py</code>. Это запустит локальный веб-сервер и автоматически откроет интерфейс в новом окне:</p><pre><code class="language-sh">python mai_mod_ui.py</code></pre></p><p><img width="850" height="1019" alt="afbeelding" src="https://github.com/user-attachments/assets/67c03a43-a7bd-4265-a5b1-5e4d62aca1fa" /></p><h2>Обзор</h2></p><h3>Токенизация</h3></p><p>Mapperatorinator преобразует beatmap-ы osu! в промежуточное представление событий, которое может быть напрямую преобразовано в токены и обратно.
Включает объекты попадания, звуки попадания, скорости слайдеров, новые комбо, точки тайминга, времена кияи, а также скорости прокрутки для taiko/mania.</p><p>Вот небольшой пример процесса токенизации:</p><p><img src="https://github.com/user-attachments/assets/84efde76-4c27-48a1-b8ce-beceddd9e695" alt="mapperatorinator_parser"></p><p>Для уменьшения размера словаря временные события квантованы с шагом 10 мс, а координаты позиции — по сетке с шагом 32 пикселя.</p><h3>Архитектура модели</h3>
Модель представляет собой оболочку вокруг <a href="https://huggingface.co/docs/transformers/en/model_doc/whisper#transformers.WhisperForConditionalGeneration" target="_blank" rel="noopener noreferrer">HF Transformers Whisper</a>, с пользовательскими входными встраиваниями и функцией потерь.
Размер модели составляет 219M параметров.
Эта модель оказалась быстрее и точнее, чем T5 для данной задачи.</p><p>Высокоуровневый обзор входа-выхода модели следующий:</p><p><img src="https://user-images.githubusercontent.com/28675590/201044116-1384ad72-c540-44db-a285-7319dd01caad.svg" alt="Picture2"></p><p>В качестве входа энкодера модель использует кадры Mel-спектрограммы, по одному кадру на позицию входа. На каждом шаге выход декодера — это softmax распределение по дискретному, предопределённому, словарю событий. Выходы разрежены, события нужны только при появлении hit-object, вместо аннотирования каждого аудиокадра.</p><h3>Формат мультизадачного обучения</h3></p><p><img src="https://github.com/user-attachments/assets/62f490bc-a567-4671-a7ce-dbcc5f9cd6d9" alt="Multitask training format"></p><p>Перед SOS-токеном идут дополнительные токены, которые способствуют условному порождению. Эти токены включают игровой режим, сложность, ID маппера, год и другую метаинформацию.
Во время обучения эти токены не имеют соответствующих меток, поэтому модель никогда их не выводит.
Также во время обучения есть случайная вероятность замены мета-токена на токен 'unknown', чтобы во время инференса можно было использовать эти 'unknown'-токены для уменьшения объёма метаинформации, которую нужно передавать модели.</p><h3>Бесшовная длинная генерация</h3></p><p>Длина контекста модели составляет 8.192 секунды. Этого явно недостаточно для генерации полного beatmap-а, поэтому песню приходится делить на несколько окон и генерировать beatmap частями.
Чтобы в сгенерированном beatmap-е не было заметных швов между окнами, мы используем перекрытие 90% и генерируем окна последовательно.
Каждое окно генерации, кроме первого, начинается с декодера, предварительно заполненного до 50% окна токенами из предыдущих окон.
Мы используем процессор логитов, чтобы убедиться, что модель не может генерировать временные токены, находящиеся в первых 50% окна генерации.
Кроме того, последние 40% окна генерации зарезервированы для следующего окна. Любые сгенерированные временные токены в этом диапазоне рассматриваются как токены EOS.
Это гарантирует, что каждый сгенерированный токен зависит как минимум от 4 секунд предыдущих токенов и 3,3 секунд будущего аудио для предсказания.</p><p>Чтобы предотвратить смещение оффсета при длительной генерации, случайные смещения были добавлены к временным событиям в декодере во время обучения.
Это заставляет его корректировать ошибки синхронизации, ориентируясь на появления в аудио, и приводит к стабильно точному оффсету.</p><h3>Уточнённые координаты с помощью диффузии</h3></p><p>Координаты позиций, генерируемые декодером, квантуются по сетке из 32 пикселей, поэтому после этого мы используем диффузию для удаления шума из координат до финальных положений.
Для этого мы обучили модифицированную версию <a href="https://github.com/OliBomby/osu-diffusion" target="_blank" rel="noopener noreferrer">osu-diffusion</a>, специализированную только на последних 10% расписания шума, и поддерживающую более сложные метаданные токены, которые использует Mapperatorinator для условной генерации.</p><p>Поскольку модель Mapperatorinator выдаёт SV слайдеров, требуемая длина слайдера фиксирована вне зависимости от формы траектории управляющих точек.
Поэтому мы пытаемся направлять процесс диффузии так, чтобы создавать координаты, соответствующие требуемым длинам слайдеров.
Мы делаем это, пересчитывая конечные позиции слайдера после каждого шага диффузии на основе требуемой длины и текущей траектории управляющих точек.
Это означает, что процесс диффузии не имеет прямого контроля над конечными позициями слайдера, но всё ещё может влиять на них, изменяя траекторию управляющих точек.</p><h3>Постобработка</h3></p><p>Mapperatorinator выполняет дополнительную постобработку для повышения качества сгенерированной карты битов:</p><ul><li>Уточнение координат позиции с помощью диффузии.</li>
<li>Привязка временных событий к ближайшему тиканью с использованием snap-делителей, сгенерированных моделью.</li>
<li>Привязка почти идеальных позиционных наложений.</li>
<li>Преобразование событий колонок mania в X-координаты.</li>
<li>Генерация путей слайдеров для таико-драмроллов.</li>
<li>Исправление больших расхождений между требуемой длиной слайдера и длиной пути управляющих точек.</li></p><p></ul><h3>Генератор супер-синхронизации</h3></p><p>Генератор супер-синхронизации — это алгоритм, который повышает точность и аккуратность сгенерированного тайминга, вычисляя тайминг для всей песни 20 раз и усредняя результаты.
Это полезно для песен с переменным BPM или с изменениями BPM. Результат практически идеален, лишь иногда требуется ручная корректировка отдельного участка.</p><h2>Обучение</h2></p><p>Инструкция ниже создаёт среду для обучения на вашем локальном компьютере.</p><h3>1. Клонируйте репозиторий</h3></p><pre><code class="language-sh">git clone https://github.com/OliBomby/Mapperatorinator.git
cd Mapperatorinator</code></pre></p><h3>2. Создайте набор данных</h3></p><p>Создайте свой собственный набор данных с помощью <a href="https://github.com/mappingtools/Mapperator/blob/master/README.md#create-a-high-quality-dataset" target="_blank" rel="noopener noreferrer">консольного приложения Mapperator</a>. Для этого потребуется <a href="https://osu.ppy.sh/home/account/edit" target="_blank" rel="noopener noreferrer">OAuth-токен клиента osu!</a> для проверки битмапов и получения дополнительных метаданных. Поместите набор данных в каталог <code>datasets</code> рядом с каталогом <code>Mapperatorinator</code>.</p><pre><code class="language-sh">Mapperator.ConsoleApp.exe dataset2 -t "/Mapperatorinator/datasets/beatmap_descriptors.csv" -i "path/to/osz/files" -o "/datasets/cool_dataset"</code></pre></p><h3>3. (Необязательно) Настройка Weight & Biases для логирования</h3>
Создайте аккаунт на <a href="https://wandb.ai/site" target="_blank" rel="noopener noreferrer">Weight & Biases</a> и получите ваш API-ключ в настройках аккаунта.
Затем установите переменную окружения <code>WANDB_API_KEY</code>, чтобы процесс обучения знал, куда логировать.</p><pre><code class="language-sh">export WANDB_API_KEY=<your_api_key></code></pre></p><h3>4. Создайте контейнер Docker</h3>
Обучение в вашем venv также возможно, но мы рекомендуем использовать Docker на WSL для лучшей производительности.
<pre><code class="language-sh">docker compose up -d --force-recreate
docker attach mapperatorinator_space
cd Mapperatorinator</code></pre></p><h3>5. Настройте параметры и начните обучение</h3></p><p>Все конфигурации находятся в <code>./configs/train/default.yaml</code>.
Убедитесь, что правильно указали <code>train_dataset_path</code> и <code>test_dataset_path</code> для вашего набора данных, а также начальные и конечные индексы mapset для разделения на обучающую и тестовую выборки.
Путь является локальным для контейнера Docker, поэтому если вы поместили свой набор данных с именем <code>cool_dataset</code> в директорию <code>datasets</code>, то путь должен быть <code>/workspace/datasets/cool_dataset</code>.</p><p>Рекомендую создать собственный файл конфигурации, который будет переопределять настройки по умолчанию, чтобы у вас была запись вашей конфигурации обучения для воспроизводимости.</p><pre><code class="language-yaml">data:
  train_dataset_path: "/workspace/datasets/cool_dataset"
  test_dataset_path: "/workspace/datasets/cool_dataset"
  train_dataset_start: 0
  train_dataset_end: 90
  test_dataset_start: 90
  test_dataset_end: 100</code></pre></p><p>Begin training by calling <code>python osuT5/train.py</code> or <code>torchrun --nproc_per_node=NUM_GPUS osuT5/train.py</code> for multi-GPU training.</p><pre><code class="language-sh">python osuT5/train.py -cn train_v29 train_dataset_path="/workspace/datasets/cool_dataset" test_dataset_path="/workspace/datasets/cool_dataset" train_dataset_end=90 test_dataset_start=90 test_dataset_end=100</code></pre></p><h3>6. Дообучение с помощью LoRA</h3></p><p>Вы также можете дообучить предварительно обученную модель с помощью <a href="https://arxiv.org/abs/2106.09685" target="_blank" rel="noopener noreferrer">LoRA</a>, чтобы адаптировать её к определённому стилю или режиму игры.
Для этого адаптируйте <code>configs/train/lora.yaml</code> под свои нужды и запустите конфигурацию обучения <code>lora</code>:</p><pre><code class="language-sh">python osuT5/train.py -cn lora train_dataset_path="/workspace/datasets/cool_dataset" test_dataset_path="/workspace/datasets/cool_dataset" train_dataset_end=90 test_dataset_start=90 test_dataset_end=100</code></pre></p><p>Важные параметры LoRA, которые следует учитывать:
<ul><li><code>pretrained_path</code>: Путь или HF-репозиторий базовой модели для дообучения.</li>
<li><code>r</code>: Ранг матриц LoRA. Более высокие значения увеличивают ёмкость модели, но также потребление памяти.</li>
<li><code>lora_alpha</code>: Масштабирующий коэффициент для обновлений LoRA.</li>
<li><code>total_steps</code>: Общее количество шагов обучения. Балансируйте в зависимости от размера вашего датасета.</li>
<li><code>enable_lora</code>: Использовать LoRA или полноценно дообучать модель.</li></p><p></ul>Во время инференса вы можете указать веса LoRA с помощью аргумента <code>lora_path</code>.
Это может быть локальный путь или репозиторий Hugging Face.</p><h2>См. также</h2>
<ul><li><a href="https://raw.githubusercontent.com/OliBomby/Mapperatorinator/main/./classifier/README.md" target="_blank" rel="noopener noreferrer">Mapper Classifier</a></li>
<li><a href="https://raw.githubusercontent.com/OliBomby/Mapperatorinator/main/./rcomplexion/README.md" target="_blank" rel="noopener noreferrer">RComplexion</a></li></p><p></ul><h2>Благодарности</h2></p><p>Особая благодарность:
<ul><li>Авторам <a href="https://github.com/gyataro/osuT5" target="_blank" rel="noopener noreferrer">osuT5</a> за их обучающий код.</li>
<li>Команде Hugging Face за их <a href="https://huggingface.co/docs/transformers/index" target="_blank" rel="noopener noreferrer">инструменты</a>.</li>
<li><a href="https://github.com/jaswon" target="_blank" rel="noopener noreferrer">Jason Won</a> и <a href="https://github.com/sedthh" target="_blank" rel="noopener noreferrer">Richard Nagyfi</a> за обмен идеями.</li>
<li><a href="https://github.com/minetoblend" target="_blank" rel="noopener noreferrer">Marvin</a> за предоставление кредитов на обучение.</li>
<li>Сообществу osu! за битмапы.</li></p><p></ul><h2>Связанные работы</h2></p><ul><li><a href="https://github.com/Syps/osu_beatmap_generator" target="_blank" rel="noopener noreferrer">osu! Beatmap Generator</a> от Syps (Nick Sypteras)</li>
<li><a href="https://github.com/kotritrona/osumapper" target="_blank" rel="noopener noreferrer">osumapper</a> от kotritrona, jyvden, Yoyolick (Ryan Zmuda)</li>
<li><a href="https://github.com/OliBomby/osu-diffusion" target="_blank" rel="noopener noreferrer">osu-diffusion</a> от OliBomby (Olivier Schipper), NiceAesth (Andrei Baciu)</li>
<li><a href="https://github.com/gyataro/osuT5" target="_blank" rel="noopener noreferrer">osuT5</a> от gyataro (Xiwen Teoh)</li>
<li><a href="https://github.com/sedthh/BeatLearning" target="_blank" rel="noopener noreferrer">Beat Learning</a> от sedthh (Richard Nagyfi)</li>
<li><a href="https://github.com/jaswon/osu-dreamer" target="_blank" rel="noopener noreferrer">osu!dreamer</a> от jaswon (Jason Won)</li></p><p>
</ul>---

Tranlated By <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">Open Ai Tx</a> | Last indexed: 2026-01-24

---</p>
        </div>
        
        <div class="original-link">
            <strong>Original README:</strong> <a href="https://raw.githubusercontent.com/OliBomby/Mapperatorinator/main/README.md" target="_blank" rel="noopener noreferrer">View on GitHub</a>
        </div>
    </div>
    
    <div class="footer">
        <p>Translated by <a href="https://github.com/OpenAiTx/OpenAiTx" target="_blank" rel="noopener noreferrer">OpenAiTx</a> | 
        Last updated: 2026-01-24 
    </div>
    
</body>
</html>